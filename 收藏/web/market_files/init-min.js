KISSY.add("utils/common/item-tpl",function(){return{html:'{{#each data}}\n<li class="project-item">\n    {{#if link}}\n        <a href="{{link}}" target="_blank">\n    {{else}}\n        <a href="//izhongchou.taobao.com/dreamdetail.htm?id={{id}}" target="_blank">\n    {{/if}}\n        <span class="project-area">\n            <img src="{{image}}_230x230.jpg" alt="" class="project-pic"/>\n            {{#if status_value === \'20\'}}\n            <span class="project-step project-prepub">{{status}}</span>\n            {{else}}\n                {{#if statusid === 1}}\n                <span class="project-step project-success">{{status}}</span>\n                {{/if}}\n                {{#if statusid === 2}}<span class="project-step">{{status}}</span>\n                {{/if}}\n                {{#if statusid === 3}}\n                <span class="project-step project-fail">{{status}}</span>\n                {{/if}}\n            {{/if}}\n            <b class="shadow"></b>\n        </span>\n        <span class="project-intro">{{name}}</span>\n        <span class="schedule-bar">\n            {{#if statusid === 1}}\n            <i class="schedule-current project-success {{#if hasfinish === 1 }}full{{/if}}" style="width:{{showWidth}}%;"></i>\n            {{/if}}\n            {{#if statusid === 2}}\n            <i class="schedule-current {{#if hasfinish === 1 }}full{{/if}}" style="width:{{showWidth}}%;"></i>\n            {{/if}}\n            {{#if statusid === 3}}\n            <i class="schedule-current project-fail {{#if hasfinish === 1 }}full{{/if}}" style="width:{{showWidth}}%;"></i>\n            {{/if}}\n        </span>\n        <span class="project-schedule">\n            <span class="other-info">\n                <span class="every-info">\n                <em>{{finish_per}}%</em>\n                <em class="info-name">\u8fbe\u6210\u7387</em>\n                </span>\n                <span class="every-info info-dollar">\n                    <em>{{curr_money}}</em>\n                    <em class="info-name">\u5df2\u7b79\u91d1\u989d</em>\n                </span>\n                <span class="every-info info-left">\n                    <em>{{#if status_value === \'20\'}}{{focus_count}}{{else}}{{buy_amount}}{{/if}}</em>\n                    {{#if status_value === \'20\'}}\n                    <em class="info-name">\u559c\u6b22\u6570</em>\n                    {{else}}\n                    <em class="info-name">\u652f\u6301\u4eba\u6570</em>\n                    {{/if}}\n                </span>\n            </span>\n        </span>\n    </a>\n</li>\n{{/each}}\n{{#if indexLink}}\n<li class="project-item">\n    <a href="{{indexLink}}" target="_blank" class="show-more"></a>\n</li>\n{{/if}}'}}),KISSY.add("utils/common/pagination",function(a,b,c,d,e){function f(b,c){if(!(this instanceof f))return new f(b,c);if(a.isObject(b))this.con=b;else if(/^#/i.test(b))this.con=a.one(b);else if(a.one("#"+b))this.con=a.one("#"+b);else{if(!a.one(b))throw new Error("Pagination Container Hooker not found");this.con=a.one(b)}f.superclass.constructor.call(this,c),this.init()}return f.ATTRS={totalPage:{value:10},currentPage:{value:1},preposePagesCount:{value:1},postposePagesCount:{value:1},firstPagesCount:{value:3},lastPagesCount:{value:3},render:{value:!0}},a.extend(f,a.Base,{init:function(){this.get("render")&&this.render()},render:function(){this.renderUI(),this.bindUI(),this.syncUI()},renderUI:function(){this._resetPagination()},bindUI:function(){var a=this;c.undelegate(a.con,"click",".item"),c.delegate(a.con,"click",".item",function(b){b.preventDefault();var c=b.currentTarget,d=parseInt(e.attr(c,"data-page"));a._switchToPage(d)}),c.undelegate(a.con,"click","a.prev"),c.delegate(a.con,"click","a.prev",function(b){b.preventDefault();var c=a.get("currentPage")-1;a._switchToPage(c)}),c.undelegate(a.con,"click","a.next"),c.delegate(a.con,"click","a.next",function(b){b.preventDefault();var c=a.get("currentPage")+1;a._switchToPage(c)})},syncUI:function(){},_resetPagination:function(){var a,b="",c=this.get("totalPage")>0?this.get("totalPage"):1,d=(this.get("currentPage")<=c&&this.get("currentPage"))>0?this.get("currentPage"):1,f=this.get("preposePagesCount")>=0?this.get("preposePagesCount"):5,g=this.get("postposePagesCount")>=0?this.get("postposePagesCount"):1,h=this.get("firstPagesCount")>=0?this.get("firstPagesCount"):5,i=this.get("lastPagesCount")>=0?this.get("lastPagesCount"):0;if(b+=1===d?"":'<a class="prev" href=""><span>&lt;\u4e0a\u4e00\u9875</span></a>',h+f+1>=d)for(var j=1;d>j;j++)b+=this._renderActivePage(j);else{for(var j=1;h>=j;j++)b+=this._renderActivePage(j);b+='<span class="more">...</span>';for(var j=d-f;d-1>=j;j++)b+=this._renderActivePage(j)}if(b+='<span class="current">'+d+"</span>",d>=c-i-g){a=d+1;for(var j=d+1;c>=j;j++)b+=this._renderActivePage(j)}else{for(var j=d+1;d+g>=j;j++)b+=this._renderActivePage(j);b+='<span class="more">...</span>';for(var j=c-i+1;c>=j;j++)b+=this._renderActivePage(j)}b+=d==c?"":'<a class="next" href="">\u4e0b\u4e00\u9875&gt;</a>',e.html(this.con,b)},_renderActivePage:function(a){return'<a class="item" data-page="'+a+'" href="">'+a+"</a>"},_switchToPage:function(a){this.set("currentPage",a),this._resetPagination(),this.fire("switch",{toPage:this.get("currentPage")})},show:function(){this.con.show()},hide:function(){this.con.hide()}}),f},{requires:["base","event","node","dom"]}),KISSY.add("utils/home2014/tool",function(a,b,c,d,e){function f(){var b=a.one("#J_PageToken");return b?b.children("input").val():""}var g=d.all,h={_csrf_token:f(),login:function(){return b.check()?!0:(window.location.href="https://login.taobao.com/member/login.jhtml?redirectURL="+encodeURIComponent(window.location.href),!1)},isDaily:function(){var a=-1!==location.host.indexOf("daily");return a?!1:!0},focus:function(a,b){var c=this,d=g(".interest");d.on("click",function(d){if(d.preventDefault(),!c.login())return!1;var f=g(d.target),h=c.isDaily()?"//izhongchou.taobao.com/dream/ajax/focusProject.htm":"//izhongchou.daily.taobao.net/dream/ajax/focusProject.htm",i="0";f.hasClass("uninterest")&&(i="1"),a&&(i="1"),e({dataType:"jsonp",url:h,data:{type:i,id:b?b:f.attr("data-id"),_tb_token_:g("#J_TbToken").val()||""},jsonp:"callback",success:function(b){if("1"==b.status)if("1"==i){if(a)return location.reload(),!1;f.removeClass("uninterest").html("+ \u52a0\u5173\u6ce8")}else f.addClass("uninterest").html("\u5df2\u5173\u6ce8")},error:function(){alert("\u670d\u52a1\u5668\u8bf7\u6c42\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5")}})})}};return h},{requires:["tbc/mini-login/1.0.0/","cookie","node","io"]}),KISSY.Config&&KISSY.Config.packages&&KISSY.Config.packages.tbc||KISSY.config({packages:[{name:"tbc",path:-1===location.host.indexOf("daily")?"//g.alicdn.com/tbc/":"//g-assets.daily.taobao.net/tbc/",ignorePackageNameInUri:!0}]}),KISSY.add("utils/common/gotop",function(a){var b="yulebao"in KISSY.unparam(location.search.slice(1));b||a.use("tbc/fixtool/1.1.0/, tbc/fixtool/1.1.0/index.css",function(a,b){b.init({useFeedback:!1,addItem:[{place:"last",html:'<a class="tbc-fixtool-box tbc-fixtool-feedback" href="http://ur.taobao.com/survey/view.htm?spm=a215p.1192983.0.0.HJVcj5&&id=2422" target="_blank"><span class="tbc-fixtool-small">\u63d0\u5efa\u8bae</span><span class="tbc-fixtool-large">\u610f\u89c1<br>\u53cd\u9988</span></a>'}],onlyLarge:!0,gotopClass:""})})}),KISSY.add("page/init",function(a,b,c,d,e,f,g,h){function i(){var b=a.unparam(window.location.hash.substring(1)),c=b.page?parseInt(b.page):1,d=this;d._renderCurrentCategory(),d._renderSortDropDown(),d._renderStatusDropDown(),d._queryAndRenderData(c),d._lightType()}function j(a){return a.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/`/g,"&#x60;").replace(/\//g,"&#x2F;").replace(/\"/g,"&quot;").replace(/\'/g,"&#x27;")}function k(b){b&&((new Image).src="//gm.mmstat.com/"+b+"?cache="+a.now())}var l=c.all,m=a.unparam(window.location.hash.substring(1)),n=a.unparam(window.location.search.substring(1)),o={pagesize:m.pagesize?m.pagesize:"20",sort:m.sort?m.sort:1,type:m.type?m.type:"",status:m.status?m.status:"",search:n.query?n.query:!1,page:1};l(".main.list").addClass("current"),o.search&&l("#q").attr("value",j(n.query)),i.prototype={_lightType:function(){function c(c){var d=l(".J_otherContent"),e=l(".J_otherDropdown"),f=d.attr("data-class"),g=c,h=g.parent("li").index();k("wapsvip.30."+(h+11));var i=g.attr("data-type"),j=g.attr("data-class");d.attr("data-type",i),d.replaceClass(f,j),d.attr("data-class",j),d.text(g.text()),e.hide(),l(".J_CategoryMenu .current").length>0&&l(".J_CategoryMenu .current")[0]!=l(".J_otherContent")[0]&&l(".J_CategoryMenu").one(".current").removeClass("current");var m={books:"-72px -40px",game:"-442px -38px",other:"-918px -38px"},n={books:"-82px -46px",game:"-452px -43px",other:"-933px -43px"};l("body").width()>1007&&void 0==b.ipad?d.addClass("current").css("backgroundPosition",m[g.attr("data-class")]):d.addClass("current").css("backgroundPosition",n[g.attr("data-class")]);var p=a.unparam(window.location.hash.substring(1)),q=g,r=p.status?p.status:"",s=p.sort?p.sort:"",t=p.type?p.type:"",u=void 0!=q.attr("data-status")?q.attr("data-status"):r,v=void 0!=q.attr("data-sort")?q.attr("data-sort"):s,w=void 0!=q.attr("data-type")?q.attr("data-type"):t;o.status=p.status=u,o.sort=p.sort=v,""==o.sort&&(o.sort=1),o.type=p.type=w,window.location.hash="#"+a.param(p),l(window).scrollTop(l("#J_Projects").offset().top-130)}function d(){for(var a=l(".J_otherDropdown a"),b=0,d=a.length;d>b;b++)if(l(a[b]).attr("data-type")==o.type){c(l(a[b]));break}}var e=this;l(".J_otherTrigger").delegate("click","span",function(c){var d=l(c.target),f=l(".J_otherDropdown");if(d.hasClass("J_otherShow"))k("wapsvip.30.10"),f.toggle();else if(d.hasClass("J_otherContent")){k("wapsvip.30.9");var g={books:"-72px -40px",game:"-442px -38px",other:"-918px -38px"},h={books:"-82px -46px",game:"-452px -43px",other:"-933px -43px"};l("body").width()>1007&&void 0==b.ipad?d.addClass("current").css("backgroundPosition",g[d.attr("data-class")]):d.addClass("current").css("backgroundPosition",h[d.attr("data-class")]),l(".J_CategoryMenu").one(".current")[0]!=d[0]&&l(".J_CategoryMenu").one(".current").removeClass("current");var i=a.unparam(window.location.hash.substring(1)),j=d,m=i.status?i.status:"",n=i.sort?i.sort:"",p=i.type?i.type:"",q=void 0!=j.attr("data-status")?j.attr("data-status"):m,r=void 0!=j.attr("data-sort")?j.attr("data-sort"):n,s=void 0!=j.attr("data-type")?j.attr("data-type"):p;o.status=i.status=q,o.sort=i.sort=r,""==o.sort&&(o.sort=1),o.type=i.type=s,window.location.hash="#"+a.param(i),l(window).scrollTop(l("#J_Projects").offset().top-130),e._queryAndRenderData(1)}}),l(".J_otherDropdown").delegate("click","a",function(a){c(l(a.target)),e._queryAndRenderData(1)}),a.each(l(".status a"),function(a,b){l(a).attr("data-status")==o.status&&l(a).addClass("current")}),d(),a.each(l(".sort a"),function(a,b){l(a).attr("data-sort")==o.sort&&l(a).addClass("current")}),a.each(l(".class a"),function(a,b){l(a).attr("data-type")==o.type&&l(a).addClass("current")}),l(".J_CategoryMenu").delegate("click",".types",function(b){b.preventDefault();var c=a.unparam(window.location.hash.substring(1)),d=l(b.currentTarget),f=d.parent("li").index();k("wapsvip.30."+(f+1)),l(".J_CategoryMenu").one(".current").removeClass("current"),l(".J_otherContent")[0].style.backgroundPosition="",d.addClass("current");var g=c.status?c.status:"",h=c.sort?c.sort:"",i=c.type?c.type:"",j=void 0!=d.attr("data-status")?d.attr("data-status"):g,m=void 0!=d.attr("data-sort")?d.attr("data-sort"):h,n=void 0!=d.attr("data-type")?d.attr("data-type"):i;o.page=c.page=1,o.status=c.status=j,o.sort=c.sort=m,""==o.sort&&(o.sort=1),o.type=c.type=n,window.location.hash="#"+a.param(c),l(window).scrollTop(l("#J_Projects").offset().top-130),e._queryAndRenderData(1)}).delegate("click",".J_Sort",function(b){var c=l(b.currentTarget).attr("data-sort"),d=a.unparam(window.location.hash.substring(1)),f=l(b.target).parent("li").index();k("wapsvip.30."+(21+f)),o.page=d.page=1,o.sort=d.sort=c,window.location.hash="#"+a.param(d),l(window).scrollTop(l("#J_Projects").offset().top-130),e._renderSortDropDown(c),e._queryAndRenderData(1)}).delegate("click",".J_Status",function(b){var c=l(b.currentTarget).attr("data-status"),d=a.unparam(window.location.hash.substring(1)),f=l(b.target).parent("li").index();k("wapsvip.30."+(17+f)),o.page=d.page=1,o.status=d.status=c,window.location.hash="#"+a.param(d),l(window).scrollTop(l("#J_Projects").offset().top-130),e._renderStatusDropDown(c),e._queryAndRenderData(1)})},_filterData:function(b){return a.each(b.data,function(a){switch(a.status){case"\u8ba1\u5212\u4e2d":a.statusid=2;break;case"\u5ba1\u6838\u4e2d":a.statusid=2;break;case"\u5ba1\u6838\u4e0d\u901a\u8fc7":a.statusid=3;case"\u5ba1\u6838\u901a\u8fc7":a.statusid=2;break;case"\u7b79\u6b3e\u4e2d":a.statusid=2;break;case"\u7b79\u6b3e\u5931\u8d25":a.statusid=3;case"\u7b79\u6b3e\u5931\u8d25\u9000\u6b3e\u6210\u529f":a.statusid=3;break;case"\u5236\u4f5c\u4e2d":a.statusid=2;break;case"\u9879\u76ee\u5ef6\u671f":a.statusid=2;case"\u9884\u70ed\u4e2d":a.statusid=1;break;case"\u9879\u76ee\u6210\u529f":a.statusid=1;break;case"\u9879\u76ee\u8fdd\u89c4":a.statusid=3;break;case"\u9879\u76ee\u5931\u8d25":a.statusid=3}}),b},_queryAndRenderData:function(a){var b,c,e=this,f=o.sort,g=o.status;if(3==g&&4==f&&(f=5),o.search){b=h.isDaily()?"//izhongchou.taobao.com/dream/ajax/searchProject.htm?_input_charset=utf-8":"//izhongchou.daily.taobao.net/dream/ajax/searchProject.htm?_input_charset=utf-8";var i,j;switch(f){case"1":i="gmt_create_desc";break;case"3":i="current_money_desc";break;case"4":i="popular_desc";break;default:i="gmt_create_desc"}switch(g){case"1":j=4;break;case"3":j=20;break;case"2":j=9;break;default:j=-1}c={q:o.search,s:j,c:""==o.type?-1:o.type,sort:i}}else b=h.isDaily()?"//izhongchou.taobao.com/dream/ajax/getProjectList.htm":"//izhongchou.daily.taobao.net/dream/ajax/getProjectList.htm",c={page:a,pageSize:o.pagesize,projectType:o.type,type:6,status:g,sort:f};window.isCDN&&!o.search&&(b="//izhongchou.taobao.com/dream/ajax/getProjectList.htm"),window.isCDN&&o.search&&(b="//izhongchou.taobao.com/dream/ajax/searchProject.htm?_input_charset=utf-8");var k={dataType:"jsonp",url:b,data:c,jsonp:"callback",success:function(b){if("1"==b.status)if(l("#J_Projects").hasClass("loading")||l("#J_Projects").addClass("loading"),""==b.data){if(!o.search)return l("#J_Projects").removeClass("loading").html('<li class="nothing">\u62b1\u6b49\uff0c\u6ca1\u6709\u627e\u5230\u76f8\u5173\u7684\u9879\u76ee</li>'),!1;e.getRecommand()}else b=e._filterData(b),e._Render(b),o.search||e._pagination(a,b.pageTotal);else e.errorHandle(),console&&console.log("\u63a5\u53e3\u8fd4\u56de\u5931\u8d25")},error:function(){if(window.isCDN&&!o.search){var b=d;b({dataType:"jsonp",url:h.isDaily()?"//izhongchou.taobao.com/dream/ajax/getProjectList.htm":"//izhongchou.daily.taobao.net/dream/ajax/getProjectList.htm",data:{page:a,pageSize:o.pagesize,projectType:o.type,type:6,status:g,sort:f},jsonp:"callback",success:function(b){if("1"==b.status){if(l("#J_Projects").hasClass("loading")||l("#J_Projects").addClass("loading"),""==b.data)return l("#J_Projects").removeClass("loading").html('<li class="nothing">\u62b1\u6b49\uff0c\u6ca1\u6709\u627e\u5230\u76f8\u5173\u7684\u9879\u76ee</li>'),!1;b=e._filterData(b),e._Render(b),e._pagination(a,b.pageTotal)}else e.errorHandle(),console&&console.log("\u63a5\u53e3\u8fd4\u56de\u5931\u8d25")},error:function(){e.errorHandle(),console&&console.log("\u670d\u52a1\u5668\u8bf7\u6c42\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5")}})}else e.errorHandle(),console&&console.log("\u670d\u52a1\u5668\u8bf7\u6c42\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5")}};window.isCDN&&(k.cache=!0,k.jsonpCallback="jsonp"+a+o.pagesize+o.type+g+f);try{var m=d;m(k)}catch(n){}},getRecommand:function(){var a=this,b=d;b({dataType:"jsonp",url:h.isDaily()?"//izhongchou.taobao.com/dream/ajax/get_recommend_list.htm":"//izhongchou.daily.taobao.net/dream/ajax/get_recommend_list.htm",data:{},jsonp:"callback",success:function(b){"1"==b.status?(b=a._filterData(b),a._Render(b,"recommand")):(a.errorHandle(),console&&console.log("\u63a5\u53e3\u8fd4\u56de\u5931\u8d25"))},error:function(){a.errorHandle(),console&&console.log("\u670d\u52a1\u5668\u8bf7\u6c42\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5")}})},_Render:function(b,c){a.each(b.data,function(a){a.finish_per=+a.finish_per||0,a.finish_per>=100?(a.hasfinish=1,a.showWidth=100):(a.hasfinish=0,a.showWidth=a.finish_per)});var d=new f(e.html).render(b);if(l("#J_Projects").removeClass("loading").html(d),o.search&&"recommand"==c){var g='<li class="search-nothing">\u5f88\u62b1\u6b49\uff01\u6839\u636e\u60a8\u7684\u641c\u7d22\u6761\u4ef6\u6ca1\u6709\u627e\u5230\u4e0e&nbsp;\u201c<span class="q">'+j(n.query)+'</span>\u201d&nbsp\u76f8\u5173\u7684\u9879\u76ee\uff0c\u53ef\u4ee5\u770b\u770b\u6211\u4eec\u4e3a\u60a8\u63a8\u8350\u7684\u5176\u4ed6\u9879\u76ee</li><li class="search-nothing-tip">\u4f60\u53ef\u80fd\u611f\u5174\u8da3\u7684\u9879\u76ee</li>';l("#J_Projects").prepend(g)}},_pagination:function(b,c){var d=this;"undefined"==typeof c&&(c=1);var e=new g("J_Pagination",{currentPage:b,totalPage:c});e.on("switch",function(b){l(window).scrollTop(l("#J_Projects").offset().top-130);var c=a.unparam(window.location.hash.substring(1));c.page=b.toPage,window.location.hash="#"+a.param(c),d._queryAndRenderData(b.toPage)})},_renderSortDropDown:function(b){var c=a.unparam(window.location.hash.substring(1));switch(b||(b=c.sort),b+""){case"1":var d="\u6700\u65b0\u4e0a\u7ebf";break;case"3":d="\u91d1\u989d\u6700\u9ad8";break;case"4":d="\u6700\u53d7\u6b22\u8fce";break;default:d="\u6700\u65b0\u4e0a\u7ebf"}l(".J_OrderTrigger").html(d),l(".J_OrderDropDown").addClass("drop-down-hidden")},_renderStatusDropDown:function(b){var c=a.unparam(window.location.hash.substring(1));switch(b||(b=c.status),b+""){case"1":var d="\u7b79\u6b3e\u4e2d";break;case"2":d="\u7b79\u6b3e\u6210\u529f";break;case"3":d="\u9884\u70ed\u4e2d";break;default:d="\u5168\u90e8"}l(".J_StatusTrigger").html(d),l(".J_StatusDropDown").addClass("drop-down-hidden")},_renderCurrentCategory:function(b){var c=a.unparam(window.location.hash.substring(1));b||(b=c.type||""),l(".types").each(function(a){l(a).attr("data-type")==b&&l(a).addClass("current")})},errorHandle:function(){l("#J_Projects").removeClass("loading").html('<li class="nothing">\u62b1\u6b49\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5\u3002</li>')}},l(document).delegate("click",".J_StatusTrigger",function(a){k("wapsvip.30.16"),l(".J_OrderDropDown").addClass("drop-down-hidden"),l(".J_StatusDropDown").toggleClass("drop-down-hidden")}).delegate("click",".J_OrderTrigger",function(a){k("wapsvip.30.15"),l(".J_StatusDropDown").addClass("drop-down-hidden"),l(".J_OrderDropDown").toggleClass("drop-down-hidden")}),function(){function a(){l(window).scrollTop()>=c.offset().top&&1!==b?(l(".J_CategoryMenu").addClass("onfix"),b=1):l(window).scrollTop()<c.offset().top&&0!==b&&(l(".J_CategoryMenu").removeClass("onfix"),b=0)}var b=0,c=l(".list-main");a(),l(window).on("scroll",function(b){a()})}(),new i},{requires:["ua","node","io","utils/common/item-tpl","xtemplate","utils/common/pagination","utils/home2014/tool","utils/common/gotop"]}),KISSY.use("page/init");