define("event-gesture",["event-dom-base","util","event-touch","feature"],function(e){var t,a,r,n,i,s,o=e("event-dom-base"),u=e("util"),g=e("event-touch"),p=e("feature");return t=function(e){function t(e,t,a){var r,i,s=e.lastTouches,o=s[0],u=o.pageX,g=o.pageY,p=u-e.startX,h=g-e.startY,f=Math.abs(p),m=Math.abs(h),T=e.direction;T||(T=f>m?0>p?"left":"right":0>h?"up":"down",e.direction=T),r="up"===T||"down"===T?m:f;var E,X,Y=t.timeStamp-e.startTime;if(a)if(e.isStarted)i=l;else{i=c;var S=window,P={left:S.pageXOffset+v,right:S.pageXOffset+S.innerWidth-v,top:S.pageYOffset+v,bottom:S.pageYOffset+S.innerHeight-v};if("right"===T&&u>P.left)return!1;if("left"===T&&u<P.right)return!1;if("down"===T&&g>P.top)return!1;if("up"===T&&g<P.bottom)return!1;e.isStarted=1,e.startTime=t.timeStamp}else i=d,"left"===T||"right"===T?E=r/Y:X=r/Y;return n.fire(o.target,i,{originalEvent:t.originalEvent,pageX:o.pageX,pageY:o.pageY,which:1,direction:T,distance:r,duration:Y/1e3,velocityX:E,velocityY:X}),void 0}function a(){}var r=g._gestureUtil,n=o,i=u,s=r.addEvent,p=r.SingleTouch,c="edgePanStart",l="edgePan",d="edgePanEnd",v=60;return i.extend(a,p,{requiredGestureType:"touch",start:function(){var e=this;a.superclass.start.apply(e,arguments);var t=e.lastTouches[0];e.direction=null,e.startX=t.pageX,e.startY=t.pageY},move:function(e){return a.superclass.move.apply(this,arguments),t(this,e,1)},end:function(e){return a.superclass.end.apply(this,arguments),t(this,e,0)}}),s([l,d,c],{handle:new a}),e={EDGE_PAN:l,EDGE_PAN_START:c,EDGE_PAN_END:d}}(),a=function(e){function t(e,t){var a=e.pageX-t.pageX,r=e.pageY-t.pageY;return Math.sqrt(a*a+r*r)}function a(e,a){var i=e.lastTouches[0],s=e.startPos;if(!e.direction){var o=a.pageX-e.startPos.pageX,u=a.pageY-e.startPos.pageY,g=Math.abs(o),c=Math.abs(u);e.direction=g>c?0>o?"left":"right":0>u?"up":"down"}t(i,s)>T&&(e.isStarted?r(e,a):(E.body.setCapture&&E.body.setCapture(),e.isStarted=!0),p.fire(e.dragTarget,v,n(e,a)))}function r(e,t){var a=e.lastTouches[0],r=t.timeStamp;r-e.lastTime>m&&(e.lastPos={pageX:a.pageX,pageY:a.pageY},e.lastTime=r)}function n(e,t,a){var r=e.startPos;a=a||{};var n=e.lastTouches[0];return a.which=1,a.pageX=n.pageX,a.pageY=n.pageY,a.originalEvent=t.originalEvent,a.deltaX=n.pageX-r.pageX,a.deltaY=n.pageY-r.pageY,a.startTime=e.startTime,a.startPos=e.startPos,a.gestureType=t.gestureType,a.direction=e.direction,a}function i(){}var s=g._gestureUtil,p=o,c=u,l=s.addEvent,d=s.SingleTouch,v="panStart",h="panEnd",f="pan",m=300,T=3,E=document;return c.extend(i,d,{start:function(){var e=this;i.superclass.start.apply(e,arguments);var t=e.lastTouches[0];e.lastTime=e.startTime,e.dragTarget=t.target,e.startPos=e.lastPos={pageX:t.pageX,pageY:t.pageY},e.direction=null},move:function(e){var t=this;i.superclass.move.apply(t,arguments),t.isStarted?(r(t,e),p.fire(t.dragTarget,f,n(t,e))):a(t,e)},end:function(e){var t=this,a=t.lastTouches[0],r=e.timeStamp,i=(a.pageX-t.lastPos.pageX)/(r-t.lastTime),s=(a.pageY-t.lastPos.pageY)/(r-t.lastTime);p.fire(t.dragTarget,h,n(t,e,{velocityX:i||0,velocityY:s||0})),E.body.releaseCapture&&E.body.releaseCapture()}}),l([v,f,h],{handle:new i}),e={PAN_START:v,PAN:f,PAN_END:h}}(),r=function(e){function t(e,t){var a=e.pageX-t.pageX,r=e.pageY-t.pageY;return Math.sqrt(a*a+r*r)}function a(){}function r(e){2===e.targetTouches.length&&e.preventDefault()}var n=g._gestureUtil,i=o,s=p,c=u,l=n.DoubleTouch,d=n.addEvent,v="pinch",h="pinchStart",f="pinchEnd";c.extend(a,l,{requiredGestureType:"touch",move:function(e){var r=this;a.superclass.move.apply(r,arguments);var n=r.lastTouches;if(n[0].pageX>0&&n[0].pageY>0&&n[1].pageX>0&&n[1].pageY>0){var s=t(n[0],n[1]);if(r.isStarted)i.fire(r.target,v,c.mix(e,{distance:s,scale:s/r.startDistance}));else{r.isStarted=!0,r.startDistance=s;var o=r.target=r.getCommonTarget(e);i.fire(o,h,c.mix(e,{distance:s,scale:1}))}}},end:function(e){var t=this;a.superclass.end.apply(t,arguments),i.fire(t.target,f,c.mix(e,{touches:t.lastTouches}))}});var m=new a;d([h,f],{handle:m});var T={handle:m};return s.isTouchEventSupported()&&(T.setup=function(){this.addEventListener("touchmove",r,!1)},T.tearDown=function(){this.removeEventListener("touchmove",r,!1)}),d(v,T),e={PINCH:v,PINCH_START:h,PINCH_END:f}}(),n=function(e){function t(){}function a(e){2===e.targetTouches.length&&e.preventDefault()}var r=g._gestureUtil,n=o,i=u,s=p,c=r.DoubleTouch,l=r.addEvent,d="rotateStart",v="rotate",h=180/Math.PI,f="rotateEnd";i.extend(t,c,{requiredGestureType:"touch",move:function(e){var a=this;t.superclass.move.apply(a,arguments);var r=a.lastTouches,s=r[0],o=r[1],u=a.lastAngle,g=Math.atan2(o.pageY-s.pageY,o.pageX-s.pageX)*h;if(void 0!==u){var p=Math.abs(g-u),c=(g+360)%360,l=(g-360)%360;Math.abs(c-u)<p?g=c:Math.abs(l-u)<p&&(g=l)}a.lastAngle=g,a.isStarted?n.fire(a.target,v,i.mix(e,{angle:g,rotation:g-a.startAngle})):(a.isStarted=!0,a.startAngle=g,a.target=a.getCommonTarget(e),n.fire(a.target,d,i.mix(e,{angle:g,rotation:0})))},end:function(e){var a=this;t.superclass.end.apply(a,arguments),a.lastAngle=void 0,n.fire(a.target,f,i.mix(e,{touches:a.lastTouches}))}});var m=new t;l([f,d],{handle:m});var T={handle:m};return s.isTouchEventSupported()&&(T.setup=function(){this.addEventListener("touchmove",a,!1)},T.tearDown=function(){this.removeEventListener("touchmove",a,!1)}),l(v,T),e={ROTATE_START:d,ROTATE:v,ROTATE_END:f}}(),i=function(e){function t(){r=void 0,d=0}function a(e){var t,a=e.accelerationIncludingGravity,s=a.x,o=a.y,u=a.z;void 0!==r&&(t=h(f(s-r),f(o-n),f(u-i)),t>c&&E(),t>l&&(d=1)),r=s,n=o,i=u}var r,n,i,s=o,g=u,p=s.Special,c=5,l=20,d=0,v="shake",h=Math.max,f=Math.abs,m=window,T="devicemotion",E=g.buffer(function(){d&&(s.fireHandler(m,v,{accelerationIncludingGravity:{x:r,y:n,z:i}}),t())},250);return p.shake={setup:function(){this===m&&m.addEventListener(T,a,!1)},tearDown:function(){this===m&&(E.stop(),t(),m.removeEventListener(T,a,!1))}},e={SHAKE:v}}(),s=function(e){var s=u,p=o,c=g,l=t,d=a,v=r,h=n,f=i,m={EdgePanGestureEvent:l,PanGestureEvent:d,PinchGestureEvent:v,RotateGestureEvent:h,ShakeGestureEvent:f};return s.mix(m,c),s.mix(p,m),e=m}()});