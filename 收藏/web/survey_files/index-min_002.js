define("survey/index",["util","node","kg/xtemplate/3.5.2/runtime","base","json","kg/overlay/0.0.4/index","io","ua"],function(e,t,n){var a,i,r,o,s,c,l,d,u,h,p,f,v,m,g,y,w,b,_,x,k,T,L,C,q,E,A,S,I,O,R,j,U,P,N,Q,M,D,V,z,$,B,F,H,W,J,G,X,Y,Z,K=e("util"),ee=e("node"),te=e("kg/xtemplate/3.5.2/runtime"),ne=e("base"),ae=e("json"),ie=(e("kg/overlay/0.0.4/index"),e("io"));e("ua");a=function(e){function t(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function n(e,t,a,i){var r,o,s,c,l=e;if(!e)return l;if(i&&e[v])return a[e[v]].destination;if("object"==typeof e){var d=e.constructor;g.inArray(d,[Boolean,String,Number,Date,RegExp])?l=new d(e.valueOf()):(r=g.isArray(e))?l=t?g.filter(e,t):e.concat():(o=g.isPlainObject(e))&&(l={}),i&&(e[v]=c=g.guid("c"),a[c]={destination:l,input:e})}if(r)for(var u=0;u<l.length;u++)l[u]=n(l[u],t,a,i);else if(o)for(s in e)s===v||t&&t.call(e,e[s],s,e)===!1||(l[s]=n(e[s],t,a,i));return l}for(var a,i=0,r=/^[\s\xa0]+|[\s\xa0]+$/g,o=/\\?\{([^{}]+)\}/g,s=String.prototype.trim,c=Array.prototype.filter,l=Array.prototype.indexOf,d=Object.prototype.toString,u="",h={},p=!{toString:1}.propertyIsEnumerable("toString"),f=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toString","toLocaleString","valueOf"],v="__~ks_cloned",m=Array.prototype.map,g=({mix:function(e,t){for(var n in t)e[n]=t[n];return e},merge:function(e){e=g.makeArray(arguments);var t,n={},a=e.length;for(t=0;a>t;t++)g.mix(n,e[t]);return n},substitute:function(e,t,n){return"string"==typeof e&&t?e.replace(n||o,function(e,n){return"\\"===e.charAt(0)?e.slice(1):t[n]===a?u:t[n]}):e},makeArray:function(e){if(null==e)return[];if(g.isArray(e))return e;var t=typeof e.length,n=typeof e;if("number"!==t||"string"==typeof e.nodeName||null!=e&&e==e.window||"string"===n||"function"===n&&!("item"in e&&"number"===t))return[e];for(var a=[],i=0,r=e.length;r>i;i++)a[i]=e[i];return a},guid:function(e){return(e||u)+i++},trim:s?function(e){return null==e?u:s.call(e)}:function(e){return null==e?u:(e+"").replace(r,u)},keys:Object.keys||function(e){var t,n,a=[];for(t in e)e.hasOwnProperty(t)&&a.push(t);if(p)for(n=f.length-1;n>=0;n--)t=f[n],e.hasOwnProperty(t)&&a.push(t);return a},indexOf:l?function(e,t,n){return n===a?l.call(t,e):l.call(t,e,n)}:function(e,t,n){for(var a=n||0,i=t.length;i>a;++a)if(t[a]===e)return a;return-1},filter:c?function(e,t,n){return c.call(e,t,n||this)}:function(e,t,n){var a=[];return g.each(e,function(e,i,r){t.call(n||this,e,i,r)&&a.push(e)}),a},map:m?function(e,t,n){return m.call(e,t,n||this)}:function(e,t,n){for(var a=e.length,i=new Array(a),r=0;a>r;r++){var o="string"==typeof e?e.charAt(r):e[r];(o||r in e)&&(i[r]=t.call(n||this,o,r,e))}return i},each:function(e,t,n){if(e){var i,r,o,s=0,c=e&&e.length,l=c===a||"[object Function]"===d.call(e);if(n=n||null,l)for(o=g.keys(e);s<o.length&&(i=o[s],t.call(n,e[i],i,e)!==!1);s++);else for(r=e[0];c>s&&t.call(n,r,s,e)!==!1;r=e[++s]);}return e},isEmptyObject:function(e){for(var t in e)if(t!==a)return!1;return!0},isPlainObject:function(e){if(!e||"object"!==g.type(e)||e.nodeType||e.window==e)return!1;var n,i;try{if((i=e.constructor)&&!t(e,"constructor")&&!t(i.prototype,"isPrototypeOf"))return!1}catch(r){return!1}for(n in e);return n===a||t(e,n)},type:function(e){var t={}.toString;return null==e?String(e):h[t.call(e)]||"object"},isNumber:function(e){return"[object Number]"===Object.prototype.toString.call(e)},isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},clone:function(e,t){var i;"object"==typeof t&&(i=t.structured,t=t.filter),i===a&&(i=!0);var r;i&&(r={});var o=n(e,t,r,i);return i&&g.each(r,function(e){if(e=e.input,e[v])try{delete e[v]}catch(t){e[v]=a}}),r=null,o},inArray:function(e,t){return g.indexOf(e,t)>-1},escapeHtml:function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")},throttle:function(e,t,n){var a,i,r,o=null,s=0;n||(n={});var c=function(){s=n.leading===!1?0:Date.now(),o=null,r=e.apply(a,i),o||(a=i=null)};return function(){var l=Date.now();s||n.leading!==!1||(s=l);var d=t-(l-s);return a=this,i=arguments,0>=d||d>t?(o&&(clearTimeout(o),o=null),s=l,r=e.apply(a,i),o||(a=i=null)):o||n.trailing===!1||(o=setTimeout(c,d)),r}},debounce:function(e,t,n){return this.throttle(e,t,n,!0)}}),y="Boolean Number String Function Date RegExp Object Array".split(" "),w=0;w<y.length;w++)!function(e,t){h["[object "+e+"]"]=t=e.toLowerCase(),g["is"+e]=function(e){return g.type(e)===t}}(y[w],w);return g.encodeImageSrc=function(e,t){return/\.png$/.test(e)?e:t?e.replace(/^http:/,"")+"_400x400.jpg":e.replace(/^http:/,"")},g.decodeImageSrc=function(e,t){return t?e.replace(/_400x400\.jpg$/,""):e.replace(/_320x320\.jpg$/,"")},g.queryString=function(e){var t={};return e?(e.split("&").map(function(e){var n,e=e.split("=");try{n=decodeURIComponent(e[1]||"")}catch(a){n=null}t[e[0]]=n}),t):t},g.strlen=function(e){for(var t=0,n=0;n<e.length;n++){var a=e.charCodeAt(n);a>=1&&126>=a||a>=65376&&65439>=a?t++:t+=2}return t},g.getImageSize=function(e,t){var n=new Image;n.src=e,n.onload=n.onerror=function(){t(n.width,n.height)}},e=g}(),i=function(e){function t(e){var t="survey_"+ +new Date,n=window[t]=new Image;n.onload=n.onerror=function(){window[t]=null},n.src=e,n=null}var n=K,a=+new Date,i="//log.mmstat.com/survey.2.1?s={s}&q={q}&t={t}",r="//log.mmstat.com/survey.2.2?s={s}&q={q}&t={t}",o=null;return e={update:function(){return a=+new Date,this},record:function(e,s,c){var l=this;return o&&clearTimeout(o),o=setTimeout(function(){var o=+new Date-a,d=c?r:i,u=n.substitute(d,{s:e,q:s,t:o});l.update(),t(u)},3e3),this}}}(),r=function(e){var t={pick:function(e,t){for(var n=e.length,a=[],i=0;i<e.length&&t;i++)Math.random()<t/n&&(t--,a.push(e[i])),n--;return a},shuffle:function(e){var t=e.length,n=t;if(!t)return e;for(var a;n>1;){n--,a=Math.floor(Math.random()*Math.max(n,2));var i=e[a];e[a]=e[n],e[n]=i}return e},flip:function(e){var t=null,n=null,a=e.length;if(!a)return e;for(t=0;a/2>t;t+=1){n=a-1-t;var i=e[t];e[t]=e[n],e[n]=i}return e},_contains:function(e,t){for(var n=0,a=e.length;a>n;n++)if(e[n]==t)return!0;return!1},_zip:function(e,t){for(var n=0,a=e.length;a>n;n++)e[n].__index=t[n];return e},_groupBy:function(e,t){for(var n={},a=0,i=e.length;i>a;a++){var r=e[a],o=r[t];r.__index=a,n[o]=n[o]||[],n[o].push(r)}return n},_shuffleGroup:function(e){for(var t=[],n=[],a=0,i=e.length;i>a;a++)t.push(e[a].__index);return e=this.shuffle(e),n=this._zip(e,t)},group:function(e,t,n){var a=(e.length,this._groupBy(e,t)),i=[];for(var r in a)if(a.hasOwnProperty(r)){var o=a[r];if(this._contains(n,r))for(var s=0,c=o.length;c>s;s++){var l=o[s],d=l.__index;delete l.__index,i[d]=l}else if(o.length<2){var d=o[0].__index;delete o[0].__index,i[d]=o[0]}else for(var u=this._shuffleGroup(o),s=0,c=u.length;c>s;s++){var l=u[s],d=l.__index;delete l.__index,i[d]=l}}return i}};return e=t}(),o=function(e){function t(e,t,a){var i=this;i.elem=e,i.duration=a.duration,i.easingFunction=n[a.easing],i.complete=a.complete,i.endAttrsObj=t,i.alreadyStartRun=!1,i.isRunning=!1,i.isComplete=!1,i.isPaused=!1,i.nowTime=0,i.frameTime=16}var n=(Math.PI,Math.pow,Math.sin,parseFloat,{easeOut:function(e){return(2-e)*e}});return t.prototype.run=function(){var e=this;if(e.elem==window){if(e.elemInitScrollTop=document.documentElement.scrollTop+document.body.scrollTop,e.elemInitScrollLeft=document.documentElement.scrollLeft+document.body.scrollLeft,e.elemInitScrollLeft==e.endAttrsObj.scrollLeft||e.elemInitScrollTop==e.endAttrsObj.scrollTop)return void e.complete(e.elem)}else e.elemInitScrollLeft=e.elem.scrollLeft,e.elemInitScrollTop=e.elem.scrollTop;e.alreadyStartRun||(e.alreadyStartRun=!0,e.isRunning=!0,e.animTimer=setInterval(function(){e._elemInNextStep(e.nowTime),e.nowTime+=e.frameTime/1e3},e.frameTime))},t.prototype._elemInNextStep=function(e){var t=this;if(e<t.duration){var n=t.easingFunction(e/t.duration);if(t.elem==window){var a=t.endAttrsObj.scrollLeft?t.elemInitScrollLeft+(t.endAttrsObj.scrollLeft-t.elemInitScrollLeft)*n:0,i=t.endAttrsObj.scrollTop?t.elemInitScrollTop+(t.endAttrsObj.scrollTop-t.elemInitScrollTop)*n:0;window.scrollTo(a,i)}else t.endAttrsObj.scrollLeft&&(t.elem.scrollLeft=t.elemInitScrollLeft+(t.endAttrsObj.scrollLeft-t.elemInitScrollLeft)*n),t.endAttrsObj.scrollTop&&(t.elem.scrollTop=t.elemInitScrollTop+(t.endAttrsObj.scrollTop-t.elemInitScrollTop)*n)}else clearInterval(t.animTimer),t._jumpEnd(),t.isComplete=!0,t.complete(t.elem)},t.prototype.stop=function(e){var t=this;this.isRunning&&(e&&t._jumpEnd(),clearInterval(this.animTimer))},t.prototype._jumpEnd=function(){var e=this;if(e.elem==window){var t=e.endAttrsObj.scrollLeft?e.endAttrsObj.scrollLeft:0,n=e.endAttrsObj.scrollTop?e.endAttrsObj.scrollTop:0;window.scrollTo(t,n)}else e.endAttrsObj.scrollLeft&&(e.elem.scrollLeft=e.endAttrsObj.scrollLeft),e.endAttrsObj.scrollTop&&(e.elem.scrollTop=e.endAttrsObj.scrollTop)},t.prototype.pause=function(){var e=this;e.isRunning&&(clearInterval(e.animTimer),e.isRunning=!1,e.isPaused=!0)},t.prototype.resume=function(){var e=this;e.isPaused&&(e.isPaused=!1,e.isRunning=!0,e.animTimer=setInterval(function(){e.nowTime+=e.frameTime/1e3,e._elemInNextStep(e.nowTime)},e.frameTime))},t.prototype.isRunning=function(){return this.isRunning},t.prototype.isPaused=function(){return this.isPaused},e=t}(),s=function(e){return e={t:function(e,t){if(I18N){var n=I18N[e];return n.replace(/<%([^%>]+)?%>/g,function(e,n){return t[n]})}throw Error("no i18n resource")}}}(),c=function(e){function t(e,t,n){}function n(e,t,n){}function a(e,t,n){}function i(e,t,n){}function r(e){return e.replace(w,"&lt;").replace(b,"&gt;")}function o(e,t,n){if(n=h(n),"href"===t||"src"===t){if(n=n.trim(),"#"===n)return"#";if("http://"!==n.substr(0,7)&&"https://"!==n.substr(0,8)&&"mailto:"!==n.substr(0,7)&&"/"!==n[0])return""}else if("background"===t){if(q.lastIndex=0,q.test(n))return""}else if("style"===t){if(C.lastIndex=0,C.test(n))return"";if(E.lastIndex=0,E.test(n))return"";if(A.lastIndex=0,A.test(n)&&(q.lastIndex=0,q.test(n)))return""}return n=p(n)}function s(e){return e.replace(_,"&quot;")}function c(e){return e.replace(x,'"')}function l(e){return e.replace(k,function(e,t){return"x"===t[0]||"X"===t[0]?String.fromCharCode(parseInt(t.substr(1),16)):String.fromCharCode(parseInt(t,10))})}function d(e){return e.replace(T,":").replace(L," ")}function u(e){for(var t="",n=0,a=e.length;a>n;n++)t+=e.charCodeAt(n)<32?" ":e.charAt(n);return t.trim()}function h(e){return e=c(e),e=l(e),e=d(e),e=u(e)}function p(e){return e=s(e),e=r(e)}function f(){return""}function v(e,t){function n(t){return a?!0:-1!==e.indexOf(t)}"function"!=typeof t&&(t=function(){});var a=!Array.isArray(e),i=[],r=!1;return{onIgnoreTag:function(e,a,o){if(n(e)){if(o.isClosing){var s="[/removed]",c=o.position+s.length;return i.push([r!==!1?r:o.position,c]),r=!1,s}return r||(r=o.position),"[removed]"}return t(e,a,o)},remove:function(e){var t="",n=0;return i.forEach(function(a){t+=e.slice(n,a[0]),n=a[1]}),t+=e.slice(n)}}}function m(e){return e.replace(S,"")}function g(e){var t=e.split("");return t=t.filter(function(e){var t=e.charCodeAt(0);return 127===t?!1:31>=t?10===t||13===t?!0:!1:!0}),t.join("")}e={};var y={a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","loop","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],sup:[],strong:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","colspan","align","valign"],tfoot:["align","valign"],th:["width","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","loop","preload","src","height","width"]},w=/</g,b=/>/g,_=/"/g,x=/&quot;/g,k=/&#([a-zA-Z0-9]*);?/gim,T=/&colon;?/gim,L=/&newline;?/gim,C=/\/\*|\*\//gm,q=/((j\s*a\s*v\s*a|v\s*b|l\s*i\s*v\s*e)\s*s\s*c\s*r\s*i\s*p\s*t\s*|m\s*o\s*c\s*h\s*a)\:/gi,E=/e\s*x\s*p\s*r\s*e\s*s\s*s\s*i\s*o\s*n\s*\(.*/gi,A=/u\s*r\s*l\s*\(.*/gi,S=/<!--[\s\S]*?-->/g;return e.whiteList=y,e.onTag=t,e.onIgnoreTag=n,e.onTagAttr=a,e.onIgnoreTagAttr=i,e.safeAttrValue=o,e.escapeHtml=r,e.escapeQuote=s,e.unescapeQuote=c,e.escapeHtmlEntities=l,e.escapeDangerHtml5Entities=d,e.clearNonPrintableCharacter=u,e.friendlyAttrValue=h,e.escapeAttrValue=p,e.onIgnoreTagStripAll=f,e.stripTagBody=v,e.stripCommentTag=m,e.stripBlankChar=g,e}(),l=function(e){function t(e){var t=e.indexOf(" ");if(-1===t)var n=e.slice(1,-1);else var n=e.slice(1,t+1);return n=n.trim().toLowerCase(),"/"===n[0]&&(n=n.slice(1)),"/"===n[n.length-1]&&(n=n.slice(0,-1)),n}function n(e){return"</"===e.slice(0,2)}function a(e,a,i){"user strict";var r="",o=0,s=!1,c=!1,l=0,d=e.length,u="",h="";for(l=0;d>l;l++){var p=e.charAt(l);if(s===!1){if("<"===p){s=l;continue}}else if(c===!1){if("<"===p){r+=i(e.slice(o,l)),s=l,o=l;continue}if(">"===p){r+=i(e.slice(o,s)),u=e.slice(s,l+1),h=t(u),r+=a(s,r.length,h,u,n(u)),o=l+1,s=!1;continue}if('"'===p||"'"===p){c=p;continue}}else if(p===c){c=!1;continue}}return o<e.length&&(r+=i(e.substr(o))),r}function i(e,t){"user strict";function n(e,n){e=e.trim(),e=e.replace(r,"").toLowerCase(),e.length<1||i.push(t(e,n||""))}for(var a=0,i=[],o=!1,s=e.length,c=0;s>c;c++){var l,d=e.charAt(c);if(o!==!1||"="!==d)if(o===!1||c!==a||'"'!==d&&"'"!==d)" "!==d||(l=e.slice(a,c).trim(),o===!1?n(l):n(o,l),o=!1,a=c+1);else{var u=e.indexOf(d,c+1);if(-1===u)break;l=e.slice(a+1,u).trim(),n(o,l),o=!1,c=u,a=c+1}else o=e.slice(a,c),a=c+1}return a<e.length&&(o===!1?n(e.slice(a)):n(o,e.slice(a))),i.join(" ").trim()}e={};var r=/[^a-zA-Z0-9_:\.\-]/gim;return e.parseTag=a,e.parseAttr=i,e}(),d=function(e){function t(e){return void 0===e||null===e}function n(e){var t=e.indexOf(" ");if(-1===t)return{html:"",closing:"/"===e[e.length-2]};e=e.slice(t+1,-1).trim();var n="/"===e[e.length-1];return n&&(e=e.slice(0,-1).trim()),{html:e,closing:n}}function a(e){e=e||{},e.stripIgnoreTag&&(e.onIgnoreTag&&console.error('Notes: cannot use these two options "stripIgnoreTag" and "onIgnoreTag" at the same time'),e.onIgnoreTag=i.onIgnoreTagStripAll),e.whiteList=e.whiteList||i.whiteList,e.onTag=e.onTag||i.onTag,e.onTagAttr=e.onTagAttr||i.onTagAttr,e.onIgnoreTag=e.onIgnoreTag||i.onIgnoreTag,e.onIgnoreTagAttr=e.onIgnoreTagAttr||i.onIgnoreTagAttr,e.safeAttrValue=e.safeAttrValue||i.safeAttrValue,e.escapeHtml=e.escapeHtml||i.escapeHtml,this.options=e}var i=c,r=l,o=r.parseTag,s=r.parseAttr;return a.prototype.process=function(e){if(e=e||"",e=e.toString(),!e)return"";var a=this,r=a.options,c=r.whiteList,l=r.onTag,d=r.onIgnoreTag,u=r.onTagAttr,h=r.onIgnoreTagAttr,p=r.safeAttrValue,f=r.escapeHtml;if(r.stripBlankChar&&(e=i.stripBlankChar(e)),r.allowCommentTag||(e=i.stripCommentTag(e)),r.stripIgnoreTagBody){var v=i.stripTagBody(r.stripIgnoreTagBody,d);d=v.onIgnoreTag}else v=!1;var m=o(e,function(e,a,i,r,o){var v={sourcePosition:e,position:a,isClosing:o,isWhite:i in c},m=l(i,r,v);if(!t(m))return m;if(v.isWhite){if(v.isClosing)return"</"+i+">";var g=n(r),y=c[i],w=s(g.html,function(e,n){var a=-1!==y.indexOf(e),r=u(i,e,n,a);if(!t(r))return r;if(a)return n=p(i,e,n),n?e+'="'+n+'"':e;var r=h(i,e,n,a);return t(r)?void 0:r}),r="<"+i;return w&&(r+=" "+w),g.closing&&(r+=" /"),r+=">"}var m=d(i,r,v);return t(m)?f(r):m},f);return v&&(m=v.remove(m)),m},e=a}(),u=function(e){function t(e){var t=typeof e;return null==e||"object"!==t&&"function"!==t}function n(e){return"[object Array]"===c.apply(e)}function a(e){return decodeURIComponent(e.replace(/\+/g," "))}var i,r="&",o="",s=encodeURIComponent,c={}.toString,l="=";return e={stringify:function(e,a,c,d){a=a||r,c=c||l,d===i&&(d=!0);var u,h,p,f,v,m=[];for(u in e){v=e[u];var g=u;if(u=s(u),t(v))m.push(u),v!==i&&m.push(c,s(v+o)),m.push(a);else if(n(v))for(h=0,f=v.length;f>h;++h)p=v[h],t(p)&&(m.push(u,d&&"[]"!==g.slice(-2)?s("[]"):o),p!==i&&m.push(c,s(p+o)),m.push(a))}return m.pop(),m.join(o)},parse:function(e,t,o){t=t||r,o=o||l;for(var s,c,d,u={},h=e.split(t),p=0,f=h.length;f>p;++p){if(s=h[p].indexOf(o),-1===s)c=a(h[p]),d=i;else{c=a(h[p].substring(0,s)),d=h[p].substring(s+1);try{d=a(d)}catch(v){console.error("decodeURIComponent error : "+d),console.error(v)}"[]"===c.slice(-2)&&(c=c.slice(0,-2))}c in u?n(u[c])?u[c].push(d):u[c]=[u[c],d]:u[c]=d}return u}}}(),h=function(e){var t="$";return e={decode:function(e){for(var n=[],a=[];e&&e.length;){if(!/^[0-9a-f]+/.test(e)){n=[];break}var i=e.indexOf(t),r=e.slice(0,i);r=parseInt(r,16),e=e.slice(i+t.length);var o=e.slice(0,r);if(a.push(o),e=e.slice(r),0===e.indexOf(t)||!e.length){e.length&&(e=e.slice(t.length));var s=a[2]||"",c=a[3]||"";if(s.indexOf(t)>-1&&c.indexOf(t)>-1){if(s=s.split(t),c=c.split(t),s.length!=c.length){n=[];break}s.forEach(function(e,t){var i=a.slice(0);i[2]=e,i[3]=c[t],n.push(i)})}else n.push(a);a=[]}}return n},encode:function(e){var n=this,a=[];return e.forEach(function(e){a.push(n.encodeItem(e))}),a.join(t)},encodeItem:function(e){for(var n,a="",i=0;i<e.length;i++)n=e[i]+"",a+=n.length.toString(16)+t+n;return a},CRLF:t}}(),p=function(e){if(window.JSON)e=JSON;else{var t,a,i,r,o,s;t=function(e){var t={"\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t",'"':'\\"'},n={},a=/["\b\f\n\r\t\x00-\x1f]/g,i=/\\\\|\\\/|\\b|\\f|\\n|\\r|\\t|\\"|\\u[0-9a-zA-Z]{4}/g;for(var r in t){var o=t[r];n[o]=r}return n["\\/"]="/",n["\\\\"]="\\",e={quote:function(e){return'"'+e.replace(a,function(e){var n;return(n=t[e])||(n="\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)),n})+'"'},unQuote:function(e){return e.slice(1,e.length-1).replace(i,function(e){var t;return(t=n[e])||(t=String.fromCharCode(parseInt(e.slice(2),16))),t})}}}(),a=function(e){var t={}.toString,n=!{toString:1}.propertyIsEnumerable("toString"),a=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toString","toLocaleString","valueOf"];return e={isArray:Array.isArray||function(e){return"[object Array]"===t.call(e)},inArray:function(e,t){for(var n=0,a=t.length;a>n;n++)if(t[n]===e)return!0;return!1},keys:Object.keys||function(e){var t,i,r=[];for(t in e)e.hasOwnProperty(t)&&r.push(t);if(n)for(i=a.length-1;i>=0;i--)t=a[i],e.hasOwnProperty(t)&&r.push(t);return r}}}(),i=function(e){var t=function(e){function t(e,t){for(var n in t)e[n]=t[n]}function n(e){return"[object Array]"===Object.prototype.toString.call(e)}function a(e,t,a){if(e){var i,r,o,s=0;if(a=a||null,n(e))for(o=e.length,r=e[0];o>s&&t.call(a,r,s,e)!==!1;r=e[++s]);else for(i in e)if(t.call(a,e[i],i,e)===!1)break}}function i(e,t){for(var n=0,a=t.length;a>n;n++)if(t[n]===e)return!0;return!1}var r={},o={SHIFT_TYPE:1,REDUCE_TYPE:2,ACCEPT_TYPE:0,TYPE_INDEX:0,PRODUCTION_INDEX:1,TO_INDEX:2},s=function(e){var n=this;n.rules=[],t(n,e),n.resetInput(n.input)};s.prototype={resetInput:function(e){t(this,{input:e,matched:"",stateStack:[s.STATIC.INITIAL],match:"",text:"",firstLine:1,lineNumber:1,lastLine:1,firstColumn:1,lastColumn:1})},getCurrentRules:function(){var e=this,t=e.stateStack[e.stateStack.length-1],n=[];return e.mapState&&(t=e.mapState(t)),a(e.rules,function(e){var a=e.state||e[3];a?i(t,a)&&n.push(e):t===s.STATIC.INITIAL&&n.push(e)}),n},pushState:function(e){this.stateStack.push(e)},popState:function(e){e=e||1;for(var t;e--;)t=this.stateStack.pop();return t},showDebugInfo:function(){var e=this,t=s.STATIC.DEBUG_CONTEXT_LIMIT,n=e.matched,a=e.match,i=e.input;n=n.slice(0,n.length-a.length);var r=(n.length>t?"...":"")+n.slice(0-t).replace(/\n/," "),o=a+i;return o=o.slice(0,t)+(o.length>t?"...":""),r+o+"\n"+new Array(r.length+1).join("-")+"^"},mapSymbol:function(e){return this.symbolMap[e]},mapReverseSymbol:function(e){var t,n=this,a=n.symbolMap,i=n.reverseSymbolMap;if(!i&&a){i=n.reverseSymbolMap={};for(t in a)i[a[t]]=t}return i?i[e]:e},lex:function(){var n,a,i,r,o,c=this,l=c.input,d=c.getCurrentRules();if(c.match=c.text="",!l)return c.mapSymbol(s.STATIC.END_TAG);for(n=0;n<d.length;n++){a=d[n];var u=a.regexp||a[1],h=a.token||a[0],p=a.action||a[2]||e;if(i=l.match(u)){o=i[0].match(/\n.*/g),o&&(c.lineNumber+=o.length),t(c,{firstLine:c.lastLine,lastLine:c.lineNumber+1,firstColumn:c.lastColumn,lastColumn:o?o[o.length-1].length-1:c.lastColumn+i[0].length});var f;return f=c.match=i[0],c.matches=i,c.text=f,c.matched+=f,r=p&&p.call(c),r=r===e?h:c.mapSymbol(r),l=l.slice(f.length),c.input=l,r?r:c.lex()}}}},s.STATIC={INITIAL:"I",DEBUG_CONTEXT_LIMIT:20,END_TAG:"$EOF"};var c=new s({rules:[["b",/^"(\\"|\\\\|\\\/|\\b|\\f|\\n|\\r|\\t|\\u[0-9a-zA-Z]{4}|[^\\"\x00-\x1f])*"/,0],[0,/^[\t\r\n\x20]/,0],["c",/^,/,0],["d",/^:/,0],["e",/^\[/,0],["f",/^\]/,0],["g",/^\{/,0],["h",/^\}/,0],["i",/^-?\d+(?:\.\d+)?(?:e-?\d+)?/i,0],["j",/^(true|false)/,0],["k",/^null/,0],["l",/^./,0]]});return r.lexer=c,c.symbolMap={$EOF:"a",STRING:"b",COMMA:"c",COLON:"d",LEFT_BRACKET:"e",RIGHT_BRACKET:"f",LEFT_BRACE:"g",RIGHT_BRACE:"h",NUMBER:"i",BOOLEAN:"j",NULL:"k",INVALID:"l",$START:"m",json:"n",value:"o",object:"p",array:"q",elementList:"r",member:"s",memberList:"t"},r.productions=[["m",["n"]],["n",["o"],function(){return this.$1}],["o",["b"],function(){return this.yy.unQuote(this.$1)}],["o",["i"],function(){return parseFloat(this.$1)}],["o",["p"],function(){return this.$1}],["o",["q"],function(){return this.$1}],["o",["j"],function(){return"true"===this.$1}],["o",["k"],function(){return null}],["r",["o"],function(){return[this.$1]}],["r",["r","c","o"],function(){return this.$1[this.$1.length]=this.$3,this.$1}],["q",["e","f"],function(){return[]}],["q",["e","r","f"],function(){return this.$2}],["s",["b","d","o"],function(){return{key:this.yy.unQuote(this.$1),value:this.$3}}],["t",["s"],function(){var e={};return e[this.$1.key]=this.$1.value,e}],["t",["t","c","s"],function(){return this.$1[this.$3.key]=this.$3.value,this.$1}],["p",["g","h"],function(){return{}}],["p",["g","t","h"],function(){return this.$2}]],r.table={gotos:{0:{n:7,o:8,q:9,p:10},2:{o:12,r:13,q:9,p:10},3:{s:16,t:17},18:{o:23,q:9,p:10},20:{o:24,q:9,p:10},21:{s:25}},action:{0:{b:[1,e,1],e:[1,e,2],g:[1,e,3],i:[1,e,4],j:[1,e,5],k:[1,e,6]},1:{a:[2,2],f:[2,2],c:[2,2],h:[2,2]},2:{b:[1,e,1],e:[1,e,2],f:[1,e,11],g:[1,e,3],i:[1,e,4],j:[1,e,5],k:[1,e,6]},3:{b:[1,e,14],h:[1,e,15]},4:{a:[2,3],f:[2,3],c:[2,3],h:[2,3]},5:{a:[2,6],f:[2,6],c:[2,6],h:[2,6]},6:{a:[2,7],f:[2,7],c:[2,7],h:[2,7]},7:{a:[0]},8:{a:[2,1]},9:{a:[2,5],f:[2,5],c:[2,5],h:[2,5]},10:{a:[2,4],f:[2,4],c:[2,4],h:[2,4]},11:{a:[2,10],f:[2,10],c:[2,10],h:[2,10]},12:{f:[2,8],c:[2,8]},13:{c:[1,e,18],f:[1,e,19]},14:{d:[1,e,20]},15:{a:[2,15],f:[2,15],c:[2,15],h:[2,15]},16:{h:[2,13],c:[2,13]},17:{c:[1,e,21],h:[1,e,22]},18:{b:[1,e,1],e:[1,e,2],g:[1,e,3],i:[1,e,4],j:[1,e,5],k:[1,e,6]},19:{a:[2,11],f:[2,11],c:[2,11],h:[2,11]},20:{b:[1,e,1],e:[1,e,2],g:[1,e,3],i:[1,e,4],j:[1,e,5],k:[1,e,6]},21:{b:[1,e,14]},22:{a:[2,16],f:[2,16],c:[2,16],h:[2,16]},23:{f:[2,9],c:[2,9]},24:{h:[2,12],c:[2,12]},25:{h:[2,14],c:[2,14]}}},r.parse=function(t,n){var a,i,r,s=this,c=s.lexer,l=s.table,d=l.gotos,u=l.action,h=s.productions,p=[null],f=n?"in file: "+n+" ":"",v=[0];for(c.resetInput(t);;){if(a=v[v.length-1],i||(i=c.lex()),r=i?u[a]&&u[a][i]:null,!r){var m,g=[];if(u[a])for(var y in u[a])g.push(s.lexer.mapReverseSymbol(y));throw m=f+"syntax error at line "+c.lineNumber+":\n"+c.showDebugInfo()+"\nexpect "+g.join(", "),new Error(m)}switch(r[o.TYPE_INDEX]){case o.SHIFT_TYPE:v.push(i),p.push(c.text),v.push(r[o.TO_INDEX]),i=null;break;case o.REDUCE_TYPE:var w,b=h[r[o.PRODUCTION_INDEX]],_=b.symbol||b[0],x=b.action||b[2],k=b.rhs||b[1],T=k.length,L=0,C=p[p.length-T];for(w=e,s.$$=C;T>L;L++)s["$"+(T-L)]=p[p.length-1-L];x&&(w=x.call(s)),C=w!==e?w:s.$$,v=v.slice(0,-1*T*2),p=p.slice(0,-1*T),v.push(_),p.push(C);var q=d[v[v.length-2]][v[v.length-1]];v.push(q);break;case o.ACCEPT_TYPE:return C}}},r}();return"undefined"!=typeof n&&(e=t),e}(),r=function(e){function n(e){return 10>e?"0"+e:e}function i(e,t,a,i,s,d,u){var h=t[e];switch(h&&"object"==typeof h&&("function"==typeof h.toJSON?h=h.toJSON(e):h instanceof Date?h=isFinite(h.valueOf())?h.getUTCFullYear()+"-"+n(h.getUTCMonth()+1)+"-"+n(h.getUTCDate())+"T"+n(h.getUTCHours())+":"+n(h.getUTCMinutes())+":"+n(h.getUTCSeconds())+"Z":null:(h instanceof String||h instanceof Number||h instanceof Boolean)&&(h=h.valueOf())),void 0!==a&&(h=a.call(t,e,h)),typeof h){case"number":return isFinite(h)?String(h):"null";case"string":return c.quote(h);case"boolean":return String(h);case"object":return h?l.isArray(h)?o(h,a,i,s,d,u):r(h,a,i,s,d,u):"null"}return void 0}function r(e,t,n,a,r,o){if(l.inArray(e,r))throw new TypeError("cyclic json");r[r.length]=e;var s=o;o+=a;var d,u,h,p;d=void 0!==n?n:l.keys(e);var f=[];for(h=0,u=d.length;u>h;h++){p=d[h];var v=i(p,e,t,n,a,r,o);if(void 0!==v){var m=c.quote(p);m+=":",a&&(m+=" "),m+=v,f[f.length]=m}}var g;if(f.length)if(a){var y=",\n"+o,w=f.join(y);g="{\n"+o+w+"\n"+s+"}"}else g="{"+f.join(",")+"}";else g="{}";return r.pop(),g}function o(e,t,n,a,r,o){if(l.inArray(e,r))throw new TypeError("cyclic json");r[r.length]=e;var s=o;o+=a;for(var c=[],d=e.length,u=0;d>u;){var h=i(String(u),e,t,n,a,r,o);void 0===h?c[c.length]="null":c[c.length]=h,++u}var p;if(c.length)if(a){var f="\n,"+o,v=c.join(f);p="[\n"+o+v+"\n"+s+"]"}else p="["+c.join(",")+"]";else p="[]";return r.pop(),p}function s(e,t,n){var a,r,o="";return t&&("function"==typeof t?r=t:l.isArray(t)&&(a=t)),"number"==typeof n?(n=Math.min(10,n),o=new Array(n+1).join(" ")):"string"==typeof n&&(o=n.slice(0,10)),i("",{"":e},r,a,o,[],"")}var c=t,l=a;return e=s}(),o=function(e){function n(e,t,a){var i,r,o,c=e[t];if("object"==typeof c)if(s.isArray(c)){i=0,r=c.length;for(var l=[];r>i;)o=n(c,String(i),a),void 0!==o&&(l[l.length]=o);c=l}else{var d=s.keys(c);for(i=0,r=d.length;r>i;i++){var u=d[i];o=n(c,u,a),void 0===o?delete c[u]:c[u]=o}}return a.call(e,t,c)}var r=i,o=t,s=a;return r.yy={unQuote:o.unQuote},e=function(e,t){var a=r.parse(String(e));return t?n({"":a},"",t):a}}(),s=function(e){var t=r,n=o;return e={version:"1.0.3",stringify:t,parse:n}}(),e=s}return e}(),f=function(e){function t(e){return decodeURIComponent(e.replace(/\+/g," "))}function n(e){return"string"==typeof e&&""!==e}var a=document,i=864e5,r=encodeURIComponent;return e={get:function(e){var i,r;return n(e)&&(r=String(a.cookie).match(new RegExp("(?:^| )"+e+"(?:(?:=([^;]*))|;|$)")))&&(i=r[1]?t(r[1]):""),i},set:function(e,t,o,s,c,l,d){var u,h=o;u=d?String(t):String(r(t)),"number"==typeof h&&(h=new Date,h.setTime(h.getTime()+o*i)),h instanceof Date&&(u+="; expires="+h.toUTCString()),n(s)&&(u+="; domain="+s),n(c)&&(u+="; path="+c),l&&(u+="; secure"),a.cookie=e+"="+u},remove:function(e,t,n,a){this.set(e,"",-1,t,n,a)}}}(),v=function(e){e=function(e){function t(e,t,n){e.data,e.affix;return t.data+=' <span class="required_error"></span> ',t}var n,a=this,i=a.root,r=a.buffer,o=a.scope,s=(a.runtime,a.name,a.pos),c=o.data,l=o.affix,d=i.nativeCommands,u=i.utils,h=(u.callFn,u.callCommand,d.range,d.foreach,d.forin,d.each,d["with"],d["if"]),p=(d.set,d.include,d.parse,d.extend,d.block);d.macro,d["debugger"];r.data+='<div class="q_wrap q_show ';var f=(n=l.isShown)!==e?n:(n=c.isShown)!==e?n:o.resolveLooseUp(["isShown"]);r=r.writeEscaped(f),r.data+='">\n    <div class="error_tips"><span></span></div>\n    <div class="question ',s.line=3;var v=(n=l.type)!==e?n:(n=c.type)!==e?n:o.resolveLooseUp(["type"]);r=r.writeEscaped(v),r.data+=" ";var m=(n=l.required)!==e?n:(n=c.required)!==e?n:o.resolveLooseUp(["required"]);r=r.writeEscaped(m),r.data+='" id="q-';var g=(n=l.code)!==e?n:(n=c.code)!==e?n:o.resolveLooseUp(["code"]);r=r.writeEscaped(g),r.data+='" data-qidx="';var y=(n=l.index)!==e?n:(n=c.index)!==e?n:o.resolveLooseUp(["index"]);r=r.writeEscaped(y),r.data+='">\n        <div class="question_title">\n            ',s.line=5;var w=(n=l.isLegacy)!==e?n:(n=c.isLegacy)!==e?n:o.resolveLooseUp(["isLegacy"]);r=h.call(a,o,{params:[!w],fn:t},r),r.data+='\n            <span class="require_tag">*</span>\n            <span class="seq">',s.line=7;var b=(n=l.index)!==e?n:(n=c.index)!==e?n:o.resolveLooseUp(["index"]);r=r.writeEscaped(b),r.data+='</span>\n            <span class="seq_dot">.</span>\n            <span class="title_content"><span>',s.line=9;var _=(n=l.description)!==e?n:(n=c.description)!==e?n:o.resolveLooseUp(["description"]);r=r.write(_),r.data+='</span></span>\n        </div>\n        <div class="question_tip">',s.line=11;var x=(n=l.tip)!==e?n:(n=c.tip)!==e?n:o.resolveLooseUp(["tip"]);r=r.writeEscaped(x),r.data+='</div>\n        <div class="question_gallery"><img src="" /></div>\n        <div class="question_content">',s.line=13;var k;return k=p.call(a,o,{params:["content"]},r),r=r.write(k),r.data+="</div>\n    </div>\n</div>",r};return e}(),m=function(e){e=function(e){function t(e,t,n){e.data,e.affix;return t.data+='<span class="choice_order"></span>',t}function n(e,n,a){var i=e.data,r=e.affix;n.data+='\n            <li class="other_options">\n                <label for="choice_',g.line=6;var o=(d=r.code)!==a?d:i.code;n=n.writeEscaped(o),n.data+='">\n                    <input\n                        type="checkbox"\n                        id="choice_',g.line=9;var s=(d=r.code)!==a?d:i.code;n=n.writeEscaped(s),n.data+='"\n                        name="answer-for-q-',g.line=10;var c=(d=e.root.affix.code)!==a?d:e.root.data.code;n=n.writeEscaped(c),n.data+='"\n                        data-value="',g.line=11;var l=(d=r.value)!==a?d:i.value;n=n.writeEscaped(l),n.data+='"\n                        data-code="',g.line=12;var h=(d=r.code)!==a?d:i.code;n=n.writeEscaped(h),n.data+='"\n                        data-other="',g.line=13;var p=(d=r.isOther)!==a?d:(d=i.isOther)!==a?d:e.resolveLooseUp(["isOther"]);n=n.writeEscaped(p),n.data+='"\n                            />\n                    <div class="other_option">\n                        ',g.line=16;var f=(d=r.legacy)!==a?d:(d=i.legacy)!==a?d:e.resolveLooseUp(["legacy"]);n=_.call(u,e,{params:[!f],fn:t},n),n.data+='\n                        <div class="choice_content">\n                            <span>',g.line=18;var v=(d=r.value)!==a?d:i.value;n=n.write(v),n.data+='</span>\n                        </div>\n                        <div class="other_option_input">\n                            <input type="text" data-code="',g.line=21;var m=(d=r.code)!==a?d:i.code;n=n.writeEscaped(m),n.data+='" placeholder="';var y=(d=e.root.affix.other_input_placeholder)!==a?d:e.root.data.other_input_placeholder;return n=n.writeEscaped(y),n.data+='">\n                        </div>\n                    </div>\n                </label>\n            </li>\n        ',n}function a(e,t,n){var a=e.data,i=e.affix;t.data+='data-exclusion="';var r=(d=i.exclusion)!==n?d:(d=a.exclusion)!==n?d:e.resolveLooseUp(["exclusion"]);return t=t.writeEscaped(r),t.data+='"',t}function i(e,t,n){e.data,e.affix;return t.data+='<span class="choice_order"></span>',t}function r(e,t,n){var a=e.data,i=e.affix;t.data+='<span class="choice_tip">';var r=(d=i.tip)!==n?d:a.tip;return t=t.write(r),t.data+="</span>",t}function o(e,t,n){var a=e.data,i=e.affix;t.data+='<span class="choice_img"><a class="iconfont choice_image_scale">&#xe610;</a><img src="';var r=(d=i.img)!==n?d:a.img;return t=t.write(r),t.data+='" /></span>',t}function s(e,t,n){var s=e.data,c=e.affix;t.data+='\n            <li>\n                <label for="choice_',g.line=28;var l=(d=c.code)!==n?d:s.code;t=t.writeEscaped(l),t.data+='">\n                    <input\n                        type="checkbox"\n                        id="choice_',g.line=31;var h=(d=c.code)!==n?d:s.code;t=t.writeEscaped(h),t.data+='"\n                        name="answer-for-q-',g.line=32;var p=(d=e.root.affix.code)!==n?d:e.root.data.code;t=t.writeEscaped(p),t.data+='"\n                        data-value="',g.line=33;var f=(d=c.value)!==n?d:s.value;
t=t.writeEscaped(f),t.data+='"\n                        data-code="',g.line=34;var v=(d=c.code)!==n?d:s.code;t=t.writeEscaped(v),t.data+='"\n                        ',g.line=35;var m=(d=c.exclusion)!==n?d:(d=s.exclusion)!==n?d:e.resolveLooseUp(["exclusion"]);t=_.call(u,e,{params:[m],fn:a},t),t.data+="\n                    />\n                    ",g.line=37;var y=(d=c.legacy)!==n?d:(d=s.legacy)!==n?d:e.resolveLooseUp(["legacy"]);t=_.call(u,e,{params:[!y],fn:i},t),t.data+='\n                    <span class="choice_content">',g.line=38;var w=(d=c.value)!==n?d:s.value;t=t.write(w),t.data+="</span>\n                    ",g.line=39;var b=(d=c.tip)!==n?d:s.tip;t=_.call(u,e,{params:[b],fn:r},t),t.data+="\n                    ",g.line=40;var x=(d=c.img)!==n?d:s.img;return t=_.call(u,e,{params:[x],fn:o},t),t.data+="\n                </label>\n            </li>\n        ",t}function c(e,t,a){var i=e.data,r=e.affix;t.data+="\n        ",g.line=4,g.line=4;var o=(d=r.isOther)!==a?d:(d=i.isOther)!==a?d:e.resolveLooseUp(["isOther"]);return t=_.call(u,e,{params:[o],fn:n,inverse:s},t),t.data+="\n    ",t}function l(e,t,n){var a=e.data,i=e.affix;t.data+='<ul class="options_column ';var r=(d=i.className)!==n?d:(d=a.className)!==n?d:e.resolveLooseUp(["className"]);t=t.writeEscaped(r),t.data+='">\n    ',g.line=3,g.line=3;var o=(d=i.options)!==n?i.options.items:(d=a.options)!==n?d.items:e.resolveLooseUp(["options","items"]);return t=b.call(u,e,{params:[o],fn:c},t),t.data+="\n</ul>",t}var d,u=this,h=u.root,p=u.buffer,f=u.scope,m=u.runtime,g=(u.name,u.pos),y=(f.data,f.affix,h.nativeCommands),w=h.utils,b=(w.callFn,w.callCommand,y.range,y.foreach,y.forin,y.each),_=(y["with"],y["if"]),x=(y.set,y.include,y.parse,y.extend,y.block);y.macro,y["debugger"];p.data+="",g.line=1;var k;return m.extendTplName="./base",p=p.async(function(e){m.extendTplBuffer=e}),m.extendTplFn=v,p=p.writeEscaped(k),p.data+="\n",g.line=2,p=x.call(u,f,{params:["content"],fn:l},p)};return e}(),g=function(e){e=function(e){function t(e,t,a){var i=e.data,r=e.affix;t.data+='<input type="text" class="question_input" name="answer-for-q-';var o=(n=r.code)!==a?n:(n=i.code)!==a?n:e.resolveLooseUp(["code"]);t=t.writeEscaped(o),t.data+='" id="answer-for-q-';var s=(n=r.code)!==a?n:(n=i.code)!==a?n:e.resolveLooseUp(["code"]);t=t.writeEscaped(s),t.data+='" placeholder="';var c=(n=r.placeholder)!==a?n:(n=i.placeholder)!==a?n:e.resolveLooseUp(["placeholder"]);return t=t.writeEscaped(c),t.data+='"/>',t}var n,a=this,i=a.root,r=a.buffer,o=a.scope,s=a.runtime,c=(a.name,a.pos),l=(o.data,o.affix,i.nativeCommands),d=i.utils,u=(d.callFn,d.callCommand,l.range,l.foreach,l.forin,l.each,l["with"],l["if"],l.set,l.include,l.parse,l.extend,l.block);l.macro,l["debugger"];r.data+="",c.line=1;var h;return s.extendTplName="./base",r=r.async(function(e){s.extendTplBuffer=e}),s.extendTplFn=v,r=r.writeEscaped(h),r.data+="\n",c.line=2,r=u.call(a,o,{params:["content"],fn:t},r)};return e}(),y=function(e){"use strict";function t(){}function n(e){var t=e;return i.test(e)||(e=new Date(e),t=e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()),t=t.replace(/\s+0{1,2}:0{1,2}:0{1,2}/,"")}var a,i=/^\d{4}-\d{1,2}-\d{1,2}(\s+\d{1,2}:\d{1,2}:\d{1,2})?$/;return a=window.console?window.console:{log:t,error:t,warn:t,info:t},e={verify:function(e,t){var n=this,i=!0;if(!e)return{result:!0};switch(t.name){case"number":i=n.verifyNumber(e,t.rule);break;case"datetime":i=n.verifyDateTime(e,t.rule);break;case"mobile":i=n.verifyMobile(e);break;case"email":i=n.verifyEmail(e);break;case"identity":i=n.verifyIdentity(e);break;case"other":i=n.verifyByRegx(e,t.rule);break;default:a.error("unknown verify method.")}return i},verifyNumber:function(e,t){var n=t.max,a=t.min,i=+e,r=/^(-)?\d+(\.\d+)?$/g.test(e);return r?t.min&&t.min.toString()&&a>i?{result:!1,msg:"输入的数字不得小于"+t.min}:t.max&&t.max.toString()&&i>n?{result:!1,msg:"输入的数字不得大于"+t.max}:{result:!0}:{result:!1,msg:"请填写数字"}},verifyDateTime:function(e,t){if(!i.test(e))return{result:!1,msg:"请填写正确的时间格式(如2016-05-06)"};if(!t||!t.start||!t.end)return{result:!0};var r=+t.start,o=+t.end;try{var s=new Date(e).getTime();if(r){var c=e&&s>=r;if(!c)return{result:!1,msg:"请填写晚于"+n(r)+"的时间"}}return o&&(c=c&&o>=s,!c)?{result:!1,msg:"请填写早于"+n(o)+"的时间"}:{result:!0}}catch(l){return a.error("verifyDateTime error: ",l),{result:!1,msg:"时间设置错误"}}},verifyMobile:function(e){return{result:e&&(/^1[3|4|5|7|8][0-9]\d{4,8}$/.test(e)||/^(\(\d{3,4}\)|\d{3,4}-|\s)?\d{7,14}$/.test(e)),msg:"请填写有效的电话号码"}},verifyEmail:function(e){return{result:e&&/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"_]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9_]+\.)+[a-zA-Z]{2,}))$/.test(e),msg:"请填写有效的电子邮件地址"}},verifyIdentity:function(e){return{result:e&&/^(\d{15}$|^\d{18}$|^\d{17}(\d|X|x))$/.test(e),msg:"请填写有效的身份证号码"}},verifyByRegx:function(e,t){if(!t)return{result:!0,msg:"规则不存在,直接通过"};var n=t.regx;try{return n=new RegExp(n,"g"),{result:e&&n.test(e),msg:"请按规则填写内容"}}catch(i){return a.error("verifyByRegx error: ",i),{result:!1,msg:"正则错误: "+t.regx}}}}}(),w=function(e){function t(e,t){e.val(e.attr("placeholder")).addClass(t).attr("data-placeholder-enable","true")}function n(e,t){"true"===e.attr("data-placeholder-enable")&&e.val("").removeClass(t).attr("data-placeholder-enable","false")}var i=ee,r=a,o="[object OperaMini]"==Object.prototype.toString.call(window.operamini),s="placeholder"in document.createElement("input")&&!o,c="placeholder"in document.createElement("textarea")&&!o;return i.prototype.placeholder=function(e){var a=this,i=a.nodeName(),o=e&&e.className||"ks-placeholder";if("input"===i||"textarea"===i)return s&&c?a:(0===r.trim(a.val()).length&&t(a,o),a.on("blur",function(){0===r.trim(a.val()).length&&t(a,o)}),a.on("focus",function(){n(a,o)}),void 0)},e}(),b=function(e){e=function(e){function t(e,t,a){var i=e.data,r=e.affix;t.data+='<textarea name="answer-for-q-';var o=(n=r.code)!==a?n:(n=i.code)!==a?n:e.resolveLooseUp(["code"]);t=t.writeEscaped(o),t.data+='" id="answer-for-q-';var s=(n=r.code)!==a?n:(n=i.code)!==a?n:e.resolveLooseUp(["code"]);t=t.writeEscaped(s),t.data+='" rows="10" placeholder="';var c=(n=r.placeholder)!==a?n:(n=i.placeholder)!==a?n:e.resolveLooseUp(["placeholder"]);return t=t.writeEscaped(c),t.data+='"></textarea>',t}var n,a=this,i=a.root,r=a.buffer,o=a.scope,s=a.runtime,c=(a.name,a.pos),l=(o.data,o.affix,i.nativeCommands),d=i.utils,u=(d.callFn,d.callCommand,l.range,l.foreach,l.forin,l.each,l["with"],l["if"],l.set,l.include,l.parse,l.extend,l.block);l.macro,l["debugger"];r.data+="",c.line=1;var h;return s.extendTplName="./base",r=r.async(function(e){s.extendTplBuffer=e}),s.extendTplFn=v,r=r.writeEscaped(h),r.data+="\n",c.line=2,r=u.call(a,o,{params:["content"],fn:t},r)};return e}(),_=function(e){e=function(e){function t(e,t,n){e.data,e.affix;return t.data+='<span class="required_error"></span>',t}function n(e,n,a){var i=e.data,r=e.affix;n.data+='\n                <tr id="subq-',p.line=9;var o=e.resolveLoose(["code"],1);n=n.writeEscaped(o),n.data+="-";var l=(s=r.code)!==a?s:i.code;n=n.writeEscaped(l),n.data+='">\n                    <th>',p.line=10;var d=(s=r.isLegacy)!==a?s:(s=i.isLegacy)!==a?s:e.resolveLooseUp(["isLegacy"]);n=y.call(c,e,{params:[!d],fn:t},n),n.data+="<span>";var u=(s=r.description)!==a?s:i.description;return n=n.write(u),n.data+="</span></th>\n                </tr>\n            ",n}function a(e,t,n){var a=e.data,i=e.affix;t.data+="\n                        <th><span>",p.line=26;var r=(s=i.value)!==n?s:a.value;return t=t.write(r),t.data+="</span></th>\n                    ",t}function i(e,t,n){var a=e.data,i=e.affix;t.data+='\n                            <td>\n                                <label for="q',p.line=36;var r=(s=i.index)!==n?s:(s=a.index)!==n?s:e.resolveLooseUp(["index"]);t=t.writeEscaped(r),t.data+="-";var o=e.resolveLoose(["code"],1);t=t.writeEscaped(o),t.data+="-";var c=(s=i.code)!==n?s:a.code;t=t.writeEscaped(c),t.data+='">\n                                    <input type="radio" id="q',p.line=37;var l=(s=i.index)!==n?s:(s=a.index)!==n?s:e.resolveLooseUp(["index"]);t=t.writeEscaped(l),t.data+="-";var d=e.resolveLoose(["code"],1);t=t.writeEscaped(d),t.data+="-";var u=(s=i.code)!==n?s:a.code;t=t.writeEscaped(u),t.data+='" name="q';var h=(s=i.index)!==n?s:(s=a.index)!==n?s:e.resolveLooseUp(["index"]);t=t.writeEscaped(h),t.data+="-";var f=e.resolveLoose(["code"],1);t=t.writeEscaped(f),t.data+='" data-row="';var v=e.resolveLoose(["code"],1);t=t.writeEscaped(v),t.data+='" data-code="';var m=(s=i.code)!==n?s:a.code;t=t.writeEscaped(m),t.data+='" data-value="';var g=(s=i.value)!==n?s:a.value;return t=t.writeEscaped(g),t.data+='">\n                                </label>\n                            </td>\n                        ',t}function r(e,t,n){var a=e.data,r=e.affix;t.data+="\n                    <tr>\n                        <th><span>",p.line=33;var o=(s=r.description)!==n?s:a.description;t=t.write(o),t.data+="</span></th>\n                        ",p.line=34,p.line=34;var l=(s=r.options)!==n?r.options.items:(s=a.options)!==n?s.items:e.resolveLooseUp(["options","items"]);return t=g.call(c,e,{params:[l],fn:i},t),t.data+="\n                    </tr>\n                ",t}function o(e,t,i){var o=e.data,l=e.affix;t.data+='<div class="matrix">\n    <div class="matrix_right_feather"></div>\n    <div class="fixed_column">\n        <table>\n            <thead><th><span></span></th></thead>\n            <tbody>\n            ',p.line=8,p.line=8;var d=(s=l.subQuestions)!==i?l.subQuestions.items:(s=o.subQuestions)!==i?s.items:e.resolveLooseUp(["subQuestions","items"]);t=g.call(c,e,{params:[d],fn:n},t),t.data+='\n            </tbody>\n        </table>\n    </div>\n    <div class="table_control">\n        <a href="javascript:void(0);" data-action="prev"><i class="iconfont">&#xe603;</i></a>\n        <a href="javascript:void(0);" data-action="next"><i class="iconfont">&#xe604;</i></a>\n    </div>\n    <div class="matrix_table">\n        <table>\n            <thead>\n                <tr>\n                    <th></th>\n                    ',p.line=25,p.line=25;var u=(s=l.options)!==i?l.options.items:(s=o.options)!==i?s.items:e.resolveLooseUp(["options","items"]);t=g.call(c,e,{params:[u],fn:a},t),t.data+="\n                </tr>\n            </thead>\n            <tbody>\n                ",p.line=31,p.line=31;var h=(s=l.subQuestions)!==i?l.subQuestions.items:(s=o.subQuestions)!==i?s.items:e.resolveLooseUp(["subQuestions","items"]);return t=g.call(c,e,{params:[h],fn:r},t),t.data+="\n            </tbody>\n        </table>\n    </div>\n</div>",t}var s,c=this,l=c.root,d=c.buffer,u=c.scope,h=c.runtime,p=(c.name,c.pos),f=(u.data,u.affix,l.nativeCommands),m=l.utils,g=(m.callFn,m.callCommand,f.range,f.foreach,f.forin,f.each),y=(f["with"],f["if"]),w=(f.set,f.include,f.parse,f.extend,f.block);f.macro,f["debugger"];d.data+="",p.line=1;var b;return h.extendTplName="./base",d=d.async(function(e){h.extendTplBuffer=e}),h.extendTplFn=v,d=d.writeEscaped(b),d.data+="\n",p.line=2,d=w.call(c,u,{params:["content"],fn:o},d)};return e}(),x=function(e){e=function(e){function t(e,t,n){e.data,e.affix;return t.data+='<span class="required_error"></span>',t}function n(e,n,a){var i=e.data,r=e.affix;n.data+='\n                <tr id="subq-',f.line=9;var o=e.resolveLoose(["code"],1);n=n.writeEscaped(o),n.data+="-";var s=(c=r.code)!==a?c:i.code;n=n.writeEscaped(s),n.data+='">\n                    <th>',f.line=10;var d=(c=r.isLegacy)!==a?c:(c=i.isLegacy)!==a?c:e.resolveLooseUp(["isLegacy"]);n=w.call(l,e,{params:[!d],fn:t},n),n.data+="<span>";var u=(c=r.description)!==a?c:i.description;return n=n.write(u),n.data+="</span></th>\n                </tr>\n            ",n}function a(e,t,n){var a=e.data,i=e.affix;t.data+="\n                        <th><span>",f.line=26;var r=(c=i.value)!==n?c:a.value;return t=t.write(r),t.data+="</span></th>\n                    ",t}function i(e,t,n){var a=e.data,i=e.affix;t.data+=' data-exclusion="';var r=(c=i.exclusion)!==n?c:(c=a.exclusion)!==n?c:e.resolveLooseUp(["exclusion"]);return t=t.writeEscaped(r),t.data+='" ',t}function r(e,t,n){var a=e.data,r=e.affix;t.data+='\n                            <td>\n                                <label for="q',f.line=36;var o=(c=r.index)!==n?c:(c=a.index)!==n?c:e.resolveLooseUp(["index"]);t=t.writeEscaped(o),t.data+="-";var s=e.resolveLoose(["code"],1);t=t.writeEscaped(s),t.data+="-";var d=(c=r.code)!==n?c:a.code;t=t.writeEscaped(d),t.data+='">\n                                    <input type="checkbox" id="q',f.line=37;var u=(c=r.index)!==n?c:(c=a.index)!==n?c:e.resolveLooseUp(["index"]);t=t.writeEscaped(u),t.data+="-";var h=e.resolveLoose(["code"],1);t=t.writeEscaped(h),t.data+="-";var p=(c=r.code)!==n?c:a.code;t=t.writeEscaped(p),t.data+='" name="q';var v=(c=r.index)!==n?c:(c=a.index)!==n?c:e.resolveLooseUp(["index"]);t=t.writeEscaped(v),t.data+="-";var m=e.resolveLoose(["code"],1);t=t.writeEscaped(m),t.data+='" data-row="';var g=e.resolveLoose(["code"],1);t=t.writeEscaped(g),t.data+='" data-code="';var y=(c=r.code)!==n?c:a.code;t=t.writeEscaped(y),t.data+='" data-value="';var b=(c=r.value)!==n?c:a.value;t=t.writeEscaped(b),t.data+='" ';var _=(c=r.exclusion)!==n?c:(c=a.exclusion)!==n?c:e.resolveLooseUp(["exclusion"]);return t=w.call(l,e,{params:[_],fn:i},t),t.data+=">\n                                </label>\n                            </td>\n                        ",t}function o(e,t,n){var a=e.data,i=e.affix;t.data+="\n                    <tr>\n                        <th><span>",f.line=33;var o=(c=i.description)!==n?c:a.description;t=t.write(o),t.data+="</span></th>\n                        ",f.line=34,f.line=34;var s=(c=i.options)!==n?i.options.items:(c=a.options)!==n?c.items:e.resolveLooseUp(["options","items"]);return t=y.call(l,e,{params:[s],fn:r},t),t.data+="\n                    </tr>\n                ",t}function s(e,t,i){var r=e.data,s=e.affix;t.data+='<div class="matrix">\n    <div class="matrix_right_feather"></div>\n    <div class="fixed_column">\n        <table>\n            <thead><th><span></span></th></thead>\n            <tbody>\n            ',f.line=8,f.line=8;var d=(c=s.subQuestions)!==i?s.subQuestions.items:(c=r.subQuestions)!==i?c.items:e.resolveLooseUp(["subQuestions","items"]);t=y.call(l,e,{params:[d],fn:n},t),t.data+='\n            </tbody>\n        </table>\n    </div>\n    <div class="table_control">\n        <a href="javascript:void(0);" data-action="prev"><i class="iconfont">&#xe603;</i></a>\n        <a href="javascript:void(0);" data-action="next"><i class="iconfont">&#xe604;</i></a>\n    </div>\n    <div class="matrix_table">\n        <table>\n            <thead>\n                <tr>\n                    <th></th>\n                    ',f.line=25,f.line=25;var u=(c=s.options)!==i?s.options.items:(c=r.options)!==i?c.items:e.resolveLooseUp(["options","items"]);t=y.call(l,e,{params:[u],fn:a},t),t.data+="\n                </tr>\n            </thead>\n            <tbody>\n                ",f.line=31,f.line=31;var h=(c=s.subQuestions)!==i?s.subQuestions.items:(c=r.subQuestions)!==i?c.items:e.resolveLooseUp(["subQuestions","items"]);return t=y.call(l,e,{params:[h],fn:o},t),t.data+="\n            </tbody>\n        </table>\n    </div>\n</div>",t}var c,l=this,d=l.root,u=l.buffer,h=l.scope,p=l.runtime,f=(l.name,l.pos),m=(h.data,h.affix,d.nativeCommands),g=d.utils,y=(g.callFn,g.callCommand,m.range,m.foreach,m.forin,m.each),w=(m["with"],m["if"]),b=(m.set,m.include,m.parse,m.extend,m.block);m.macro,m["debugger"];u.data+="",f.line=1;var _;return p.extendTplName="./base",u=u.async(function(e){p.extendTplBuffer=e}),p.extendTplFn=v,u=u.writeEscaped(_),u.data+="\n",f.line=2,u=b.call(l,h,{params:["content"],fn:s},u)};return e}(),k=function(e){e=function(e){function t(e,t,a){var i=e.data,r=e.affix;t.data+='<div class="question_image_upload">\n    <iframe id="iframe_',c.line=3;var o=(n=r.code)!==a?n:(n=i.code)!==a?n:e.resolveLooseUp(["code"]);t=t.writeEscaped(o),t.data+='" scrolling="no" src="/uploader?code=';var s=(n=r.code)!==a?n:(n=i.code)!==a?n:e.resolveLooseUp(["code"]);t=t.writeEscaped(s),t.data+="&value=";var l=(n=r.btnText)!==a?n:(n=i.btnText)!==a?n:e.resolveLooseUp(["btnText"]);t=t.writeEscaped(l),t.data+="&allowExts=";var d=(n=r.allowExts)!==a?n:(n=i.allowExts)!==a?n:e.resolveLooseUp(["allowExts"]);t=t.writeEscaped(d),t.data+="&defaultValue=";var u=(n=r.defaultValue)!==a?n:(n=i.defaultValue)!==a?n:e.resolveLooseUp(["defaultValue"]);return t=t.writeEscaped(u),t.data+='" frameborder="0" class="image_upload_input"></iframe>\n</div>',t}var n,a=this,i=a.root,r=a.buffer,o=a.scope,s=a.runtime,c=(a.name,a.pos),l=(o.data,o.affix,i.nativeCommands),d=i.utils,u=(d.callFn,d.callCommand,l.range,l.foreach,l.forin,l.each,l["with"],l["if"],l.set,l.include,l.parse,l.extend,l.block);l.macro,l["debugger"];r.data+="",c.line=1;var h;return s.extendTplName="./base",r=r.async(function(e){s.extendTplBuffer=e}),s.extendTplFn=v,r=r.writeEscaped(h),r.data+="\n",c.line=2,r=u.call(a,o,{params:["content"],fn:t},r)};return e}(),T=function(e){e=function(e){function t(e,t,n){e.data,e.affix;return t.data+='<span class="required_error"></span>',t}function n(e,t,n){e.data,e.affix;return t.data+=" rank_icon_last ",t}function a(e,t,a){var i=e.data;e.affix;t.data+='\n                                    <span class="rank_icon ',w.line=16;var r=i,o=r,s=e.resolveLoose(["magnitude"],1),c=s;c=s-1,o=r===c,t=T.call(p,e,{params:[o],fn:n},t),t.data+='" id="q';var l=e.resolveLoose(["code"],2);t=t.writeEscaped(l),t.data+="-";var d=e.resolveLoose(["code"],1);t=t.writeEscaped(d),t.data+="-";var u=i;t=t.writeEscaped(u),t.data+='"data-value="';var h=i,f=h;f=h+1,t=t.writeEscaped(f),t.data+='" data-row="';var v=e.resolveLoose(["code"],1);t=t.writeEscaped(v),t.data+='">\n                                        <i class="iconfont rank_icon_unchecked">',w.line=17;var m=e.resolveLoose(["shape",0],1);t=t.write(m),t.data+='</i>\n                                        <i class="iconfont rank_icon_checked">',w.line=18;var g=e.resolveLoose(["shape",1],1);t=t.write(g),t.data+="</i>\n                                        ",w.line=19;var y=i,b=y;return b=y+1,t=t.writeEscaped(b),t.data+="\n                                    </span>\n                                ",t}function i(e,n,i){var r=e.data,o=e.affix;n.data+='\n                        <tr class="rank_matrix_item" data-code="',w.line=12;var s=(h=o.code)!==i?h:r.code;n=n.writeEscaped(s),n.data+='" id="subq-';var c=e.resolveLoose(["code"],1);n=n.writeEscaped(c),n.data+="-";var l=(h=o.code)!==i?h:r.code;n=n.writeEscaped(l),n.data+='">\n                            <th class="rank_matrix_description">',w.line=13;var d=(h=o.isLegacy)!==i?h:(h=r.isLegacy)!==i?h:e.resolveLooseUp(["isLegacy"]);n=T.call(p,e,{params:[!d],fn:t},n),n.data+="";var u=(h=o.description)!==i?h:r.description;n=n.write(u),n.data+='</th>\n                            <td class="rank_matrix_options">\n                                ',w.line=15,w.line=15;var f,v=e.resolveLoose(["magnitude"],1);return f=x.call(p,e,{params:[0,v]},n),n=k.call(p,e,{params:[f],fn:a},n),n.data+="\n                            </td>\n                        </tr>\n                    ",n}function r(e,t,n){e.data,e.affix;return t.data+='<span class="required_error"></span>',t}function o(e,t,n){var a=e.data;e.affix;t.data+='-->\n                        <!--<span class="rank_icon" data-value="',w.line=32;var i=a,r=i;r=i+1,t=t.writeEscaped(r),t.data+='" data-row="';var o=e.resolveLoose(["code"],1);t=t.writeEscaped(o),t.data+='">-->\n                            <!--<i class="iconfont rank_icon_unchecked">',w.line=33;var s=e.resolveLoose(["shape",0],1);t=t.write(s),t.data+='</i>-->\n                            <!--<i class="iconfont rank_icon_checked">',w.line=34;var c=e.resolveLoose(["shape",1],1);t=t.write(c),t.data+="</i>-->\n                            <!--",w.line=35;var l=a,d=l;return d=l+1,t=t.writeEscaped(d),t.data+="-->\n                        <!--</span>-->\n                    <!--",t}function s(e,t,n){var a=e.data,i=e.affix;t.data+='-->\n            <!--<div class="rank_matrix_item" data-code="',w.line=28;var s=(h=i.code)!==n?h:a.code;t=t.writeEscaped(s),t.data+='">-->\n                <!--<div class="rank_matrix_description">',w.line=29;var c=(h=i.isLegacy)!==n?h:(h=a.isLegacy)!==n?h:e.resolveLooseUp(["isLegacy"]);t=T.call(p,e,{params:[!c],fn:r},t),t.data+="";var l=(h=i.description)!==n?h:a.description;t=t.write(l),t.data+='</div>-->\n                <!--<div class="rank_matrix_options">-->\n                    <!--',w.line=31,w.line=31;var d,u=e.resolveLoose(["magnitude"],1);return d=x.call(p,e,{params:[0,u]},t),t=k.call(p,e,{params:[d],fn:o},t),t.data+="-->\n                <!--</div>-->\n            <!--</div>-->\n            <!--",t}function c(e,t,n){var a=e.data,r=e.affix;t.data+='\n        <div class="rank_matrix_table">\n            <table>\n                <tbody>\n                    ',w.line=11,w.line=11;var o=(h=r.subQuestions)!==n?r.subQuestions.items:(h=a.subQuestions)!==n?h.items:e.resolveLooseUp(["subQuestions","items"]);t=k.call(p,e,{params:[o],fn:i},t),t.data+="\n                </tbody>\n            </table>\n            <!--",w.line=27,w.line=27;var c=(h=r.subQuestions)!==n?r.subQuestions.items:(h=a.subQuestions)!==n?h.items:e.resolveLooseUp(["subQuestions","items"]);return t=k.call(p,e,{params:[c],fn:s},t),t.data+="-->\n        </div>\n    ",t}function l(e,t,n){var a=e.data,i=e.affix;t.data+='\n                <span class="rank_icon" data-value="',w.line=45;var r=a,o=r;o=r+1,t=t.writeEscaped(o),t.data+='">\n                    <i class="iconfont rank_icon_unchecked">',w.line=46;var s=(h=i.shape)!==n?i.shape[0]:(h=a.shape)!==n?h[0]:e.resolveLooseUp(["shape",0]);t=t.write(s),t.data+='</i>\n                    <i class="iconfont rank_icon_checked">',w.line=47;var c=(h=i.shape)!==n?i.shape[1]:(h=a.shape)!==n?h[1]:e.resolveLooseUp(["shape",1]);t=t.write(c),t.data+="</i>\n                    ",w.line=48;var l=a,d=l;return d=l+1,t=t.writeEscaped(d),t.data+="\n                </span>\n            ",t}function d(e,t,n){var a=e.data,i=e.affix;t.data+='\n        <div class="rank_options">\n            ',w.line=44,w.line=44;var r,o=(h=i.magnitude)!==n?h:(h=a.magnitude)!==n?h:e.resolveLooseUp(["magnitude"]);return r=x.call(p,e,{params:[0,o]},t),t=k.call(p,e,{params:[r],fn:l},t),t.data+="\n        </div>\n    ",t}function u(e,t,n){var a=e.data,i=e.affix;t.data+='<div class="';var r=(h=i.className)!==n?h:(h=a.className)!==n?h:e.resolveLooseUp(["className"]);t=t.writeEscaped(r),t.data+='">\n    <div class="rank_label">\n        <span class="highest_label">',w.line=4;var o=(h=i.label)!==n?i.label[1]:(h=a.label)!==n?h[1]:e.resolveLooseUp(["label",1]);t=t.writeEscaped(o),t.data+='</span>\n        <span class="lowest_label">',w.line=5;var s=(h=i.label)!==n?i.label[0]:(h=a.label)!==n?h[0]:e.resolveLooseUp(["label",0]);t=t.writeEscaped(s),t.data+="</span>\n    </div>\n    ",w.line=7,w.line=7;var l=(h=i.isMatrix)!==n?h:(h=a.isMatrix)!==n?h:e.resolveLooseUp(["isMatrix"]);return t=T.call(p,e,{params:[l],fn:c,inverse:d},t),t.data+="\n</div>",t}var h,p=this,f=p.root,m=p.buffer,g=p.scope,y=p.runtime,w=(p.name,p.pos),b=(g.data,g.affix,f.nativeCommands),_=f.utils,x=(_.callFn,_.callCommand,b.range),k=(b.foreach,b.forin,b.each),T=(b["with"],b["if"]),L=(b.set,b.include,b.parse,b.extend,b.block);b.macro,b["debugger"];m.data+="",w.line=1;var C;return y.extendTplName="./base",m=m.async(function(e){y.extendTplBuffer=e}),y.extendTplFn=v,m=m.writeEscaped(C),m.data+="\n",w.line=2,m=L.call(p,g,{params:["content"],fn:u},m)};return e}(),L=function(e){var t=a,n={},i={},r={},o={},s=!1,c={isEqual:function(e,n){if(e=t.makeArray(e),n=t.makeArray(n),e.sort(),n.sort(),e.length!==n.length)return!1;for(var a=0;a<e.length;a++)if(e[a]!==n[a])return!1;return!0},"in":function(e,n){return t.isArray(e)&&(e=e[0]),n=t.makeArray(n),t.inArray(e,n)},has:function(e,n){for(var a=0;a<n.length;a++)if(!t.inArray(n[a],e))return!1;return!0},not:function(e,n){if(e=t.makeArray(e),n=t.makeArray(n),!e||0===e.length)return!1;for(var a=0;a<e.length;a++)if(t.inArray(e[a],n))return!1;return!0},isAnswered:function(e,t){return e&&e.length}},l=t.keys(c);return t.each(l,function(e){c[e]=function(e){return function(t,a){return i[t]?e(i[t],n[a]):!1}}(c[e]),c["no_"+e]=function(e){return function(){return!e.apply(e,arguments)}}(c[e])}),e={init:function(e,n){function a(e){return c[e]||(c[e]={key:e,parent:null,children:{}}),c[e]}this.logic=e,this.validators={},this.callback=n;for(var i in e){o[i]=[];var r=this.parse(e[i],i);this.validators[i]=new Function("var self = this;return "+r),s=!0}if(s){var c={},l=!1;for(var i in o){var d=a(i);t.each(o[i],function(e){e.indexOf("-")>-1&&(l=!0);var t=a(e);d.parent=t,t.children[i]||(t.children[i]=d)})}if(l)for(var i in c)if(i.indexOf("-")>-1){var u=i.split("-")[0],d=a(u);c[i].parent=d,d.isMatrix=!0,d.children[i]||(d.children[i]=c[i])}this.nodes=c}},handle:function(e,t){var n,a=[e];do if(n=a.pop()){n.key!==e.key&&t(n);var i=n.children;if(i)for(var r in i)a.push(i[r])}while(a.length);return this},reset:function(){for(var e in this.nodes)this.nodes[e].visited=!1;return this},parse:function(e,n){var a=this,i=[];if(e.group&&e.group.length){var r="or"===e.operator.toLowerCase()?"||":"&&";i.push("(");var o=[];t.each(e.group,function(e){o.push(a.parse(e,n))}),i.push(o.join(r)),i.push(")")}else i.push(this.parseLogicItem(e,n));return i.join("")},parseLogicItem:function(e,a){var i=e.operator,r=e.p;0===r.indexOf("{")&&(r=r.slice(1,-1)),t.inArray(r,o[a])||o[a].push(r);var a=(Math.random()*new Date).toString(32);return n[a]=e.q,t.substitute('self["{operator}"]("{p}","{key}")',{operator:i.replace(/^!/,"no_"),p:r,key:a})},input:function(e,n){if(s){var a=[],o=[],l={},d=this.validators,u=this.callback,h=this.nodes,p=this;if(t.isPlainObject(e)){i=t.merge(i,e),r=t.merge(r,e);var f=t.keys(this.logic);f.sort(function(e,t){return n[e]-n[t]}),t.each(f,function(e){"undefined"==typeof l[e]&&(l[e]=d[e].call(c),l[e]?a.push(e):(i[e]=null,o.push(e)),p.handle(h[e],function(e){var t=e.key;if("undefined"==typeof l[t]){var n=d[e.key];if(t.indexOf("-")>-1){var s=t.split("-")[0];if("undefined"==typeof l[s]&&d[s]){var u=d[s].call(c);l[s]=u}if(l[s])a.push(s);else{o.push(s);var p=h[s].children;for(var f in p)i[f]=null}}if(n){var u=n.call(c);l[t]=u,u?(i[e.key]=i[e.key]||r[e.key],a.push(e.key)):(i[e.key]=null,o.push(e.key))}if(e.isMatrix){var p=e.children;if(l[e.key]===!1)for(var v in p)i[v]=null;else for(var v in p)i[v]=i[v]||r[v]}}}))})}else{if(i[e]=n,r[e]=n,!h[e])return;this.handle(h[e],function(e){var t=d[e.key],n=e.key;if(n.indexOf("-")>-1){var s=n.split("-")[0];if("undefined"==typeof l[s]&&d[s]){var u=d[s].call(c);l[s]=u}if(l[s])a.push(s);else{o.push(s);var p=h[s].children;for(var f in p)i[f]=null}}if(t){var u=t.call(c);u?(i[e.key]=i[e.key]||r[e.key],a.push(e.key)):(i[e.key]=null,o.push(e.key))}if(e.isMatrix){var p=e.children;if(l[e.key]===!1)for(var v in p)i[v]=null;else for(var v in p)i[v]=i[v]||r[v]}})}this.reset(),u({show:a,hide:o})}}}}(),C=function(e){var t=["alibaba.com","alibaba.cn","alibaba.com.cn","taobao.com","taobao.cn","taobao.com.cn","taobao.net","taobao.org","ali.com","alipay.com","alipay.com.cn","alipay.net","zhifubao.com","zhifu.com","aliexpress.com","1688.com","1688.com.cn","1688.cn","yahoo.cn","yahoo.com.cn","alisoft.com","alisoft.cn","alisoft.com.cn","alimama.com","alimama.cn","alimama.com.cn","koubei.com","koubei.cn","koubei.com.cn","koubei.org","aliimg.com","aliimg.net","alixueyuan.net","alibado.com","alibaba-inc.com","aliloan.com","atpanel.com","taobaocdn.com","taojianghu.com","taojapan.com","hitao.com","taohua.com","tbsandbox.com","tao123.com","tmall.com","etao.com","youshuyuan.com","wmlp.com","juhuasuan.com","tbcdn.com","urltb.cn","aliyun.com","alibado.com","yisou.com","xiami.com","suopingbao.com","laiwang.com","tb.cn","alicdn.com","dingtalk.com","gein.cn","sm.cn","alitrip.com","net.cn","itao.com","tdd.la","alidayu.com","alibabagroup.com","youku.com","tudou.com"];return e={isSafeDomain:function(e){if(!e)return!1;for(var n=0;n<t.length;n++){var a=e.indexOf(t[n]);if(e.substring(a)==t[n])return!0}return!1}}}(),q=function(e){function t(e,t){var n=new i(t);return n.process(e)}e={};var n=c,a=l,i=d;Array.prototype.indexOf||(Array.prototype.indexOf=function(e){for(var t=0;t<this.length;t++)if(this[t]===e)return t;return-1}),Array.prototype.forEach||(Array.prototype.forEach=function(e,t){for(var n=0;n<this.length;n++)e.call(t,this[n],n,this)}),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/(^\s*)|(\s*$)/g,"")}),e=e=t,e.FilterXSS=i;for(var r in n)e[r]=n[r];for(var r in a)e[r]=a[r];return e}(),E=function(e){function t(){return"production"===k}function n(e,t){e.url||(e={url:e});var n={};return t=d.merge({},s,t),setTimeout(function(){var a=o({url:e.url,type:e.type||"POST",dataType:"json",data:t,success:function(){n.finish&&n.finish.apply(a,arguments),n.success&&n.success.apply(a,arguments),n=null},error:function(){var e=g.stringify({r:t.ctoken,s:a.status,c:document.cookie,t:a.responseText||response});window.JSTracker2?(JSTracker2._debug=!0,JSTracker2.push({msg:e})):window.JSTracker&&JSTracker.send({msg:e,sampling:1}),n.finish&&n.finish.apply(a,arguments),n.error&&n.error.apply(a,arguments),n=null}})},0),{done:function(e){return n.success=e,this},error:function(e){return n.error=e,this},finish:function(e){return n.finish=e,this}}}function i(e){var t,n=[],a=!1,i=[];for(var r in b)if(t=b[r],e||t.updated){var o=[t.question_code,t.sub_question_code||"",t.option_code||"",t.option_checked||"",t.answer_value||""];a=!0,i.push(r),n.push(m.encodeItem(o)),T&&console.log&&console.log(o)}if(a){n=n.join(w);var s=n.length.toString(16);return n=s+w+n,{data:n,keys:i}}return null}function r(e){var t=[e.question_code];return e.sub_question_code&&t.push(e.sub_question_code),("0"===e.option_checked||"1"===e.option_checked)&&t.push(e.option_code),t.join("_")}var o,s,c,l,d=a,v=u,m=h,g=p,y=f,w=m.CRLF,b={},_=!1,x=5e3,k="production",T=location.search.indexOf("debug")>-1,L=+new Date,C=function(e){return window.JSON?JSON.stringify(e):e};return e={init:function(e,a,i){if(a=a||{},!o){i=i||{},C=i.encode||C,o=e,a.id||window.JSTracker2&&(JSTracker2._debug=!0,JSTracker2.push({msg:"no data"}));try{a.ctoken=y.get("ctoken")}catch(r){a.ctoken=window.survey&&window.survey.ctoken,y.set("ctoken",a.ctoken)}a.ctoken||window.JSTracker2&&(JSTracker2._debug=!0,JSTracker2.push({msg:"no ctoken\n"+document.cookie})),a.hash||(a.hash=location.pathname.split("/").slice(-1)[0]),s=a,this.isTest=i.test;var l=location.search.replace("?",""),u={};l&&(u=v.parse(l)),c=u.ref||document.referrer||"",d.isArray(c)&&(c=c[0]),c.indexOf(location.host)>-1&&c.indexOf("/login")>-1&&(c=""),k=a.env||k,setTimeout(function(){t()&&n("/api/survey/begin",{ref:c})},0)}return this},answer:function(e,a){var o=this;if(e.option_checked=0===e.option_checked?"0":(e.option_checked||"")+"",e.option_code=0===e.option_code?"0":(e.option_code||"")+"",e.answer_value&&(e.answer_value=d.trim(e.answer_value)),e.option_code||e.answer_value){var s=r(e),c=b[s]||{};c.question_code=e.question_code,c.option_code=e.option_code,c.option_checked=e.option_checked,c.sub_question_code=e.sub_question_code||"",c.answer_value=e.answer_value||c.answer_value||"",c.updated=!0,b[s]=c,t()&&a!==!1&&(l&&clearTimeout(l),l=setTimeout(function(){if(!o.submitted&&!_){_=!0;var e=i();if(!e)return;return n("/api/survey/answerQuestion",{answers:e.data}).done(function(){for(var t=e.keys,n=0;n<t.length;n++)b[t[n]].updated=!1;_=!1}).error(function(){_=!1})}},x))}},submit:function(e){if(!this.isSubmitting){e=e||{};var a=i(!0);a&&(e.answers=a.data),l&&clearTimeout(l),this.submitted=!0,this.isSubmitting=!0,e.st=L,t()||(e.env=k);var r=this;return n("/api/survey/submit",e).finish(function(){r.isSubmitting=!1})}},getResult:function(e){return n("/api/survey/result",e)}}}(),A=function(e){e=function(e){function t(e,t,n){e.data,e.affix;return t.data+='<span class="choice_order"></span>',t}function n(e,n,a){
var i=e.data,r=e.affix;n.data+='\n            <li class="other_options">\n                <label for="choice_',g.line=6;var o=(d=r.code)!==a?d:i.code;n=n.writeEscaped(o),n.data+='">\n                    <input\n                        type="radio"\n                        id="choice_',g.line=9;var s=(d=r.code)!==a?d:i.code;n=n.writeEscaped(s),n.data+='"\n                        name="answer-for-q-',g.line=10;var c=(d=e.root.affix.code)!==a?d:e.root.data.code;n=n.writeEscaped(c),n.data+='"\n                        data-value="',g.line=11;var l=(d=r.value)!==a?d:i.value;n=n.writeEscaped(l),n.data+='"\n                        data-code="',g.line=12;var h=(d=r.code)!==a?d:i.code;n=n.writeEscaped(h),n.data+='"\n                        data-other="',g.line=13;var p=(d=r.isOther)!==a?d:(d=i.isOther)!==a?d:e.resolveLooseUp(["isOther"]);n=n.writeEscaped(p),n.data+='"\n                    />\n                    <div class="other_option">\n                        ',g.line=16;var f=(d=r.legacy)!==a?d:(d=i.legacy)!==a?d:e.resolveLooseUp(["legacy"]);n=_.call(u,e,{params:[!f],fn:t},n),n.data+='\n                        <div class="choice_content">\n                            <span>',g.line=18;var v=(d=r.value)!==a?d:i.value;n=n.write(v),n.data+='</span>\n                        </div>\n                        <div class="other_option_input">\n                            <input type="text" data-code="',g.line=21;var m=(d=r.code)!==a?d:i.code;n=n.writeEscaped(m),n.data+='" placeholder="';var y=(d=e.root.affix.other_input_placeholder)!==a?d:e.root.data.other_input_placeholder;return n=n.writeEscaped(y),n.data+='">\n                        </div>\n                    </div>\n                </label>\n            </li>\n        ',n}function a(e,t,n){var a=e.data,i=e.affix;t.data+='data-exclusion="';var r=(d=i.exclusion)!==n?d:(d=a.exclusion)!==n?d:e.resolveLooseUp(["exclusion"]);return t=t.writeEscaped(r),t.data+='"',t}function i(e,t,n){e.data,e.affix;return t.data+='<span class="choice_order"></span>',t}function r(e,t,n){var a=e.data,i=e.affix;t.data+='<span class="choice_tip">';var r=(d=i.tip)!==n?d:a.tip;return t=t.write(r),t.data+="</span>",t}function o(e,t,n){var a=e.data,i=e.affix;t.data+='<span class="choice_img"><a class="iconfont choice_image_scale">&#xe610;</a><img src="';var r=(d=i.img)!==n?d:a.img,o=r,s=(d=e.root.affix.img_postfix)!==n?d:e.root.data.img_postfix;return o=r+s,t=t.write(o),t.data+='" /></span>',t}function s(e,t,n){var s=e.data,c=e.affix;t.data+='\n            <li>\n                <label for="choice_',g.line=28;var l=(d=c.code)!==n?d:s.code;t=t.writeEscaped(l),t.data+='">\n                    <input\n                        type="radio"\n                        id="choice_',g.line=31;var h=(d=c.code)!==n?d:s.code;t=t.writeEscaped(h),t.data+='"\n                        name="answer-for-q-',g.line=32;var p=(d=e.root.affix.code)!==n?d:e.root.data.code;t=t.writeEscaped(p),t.data+='"\n                        data-value="',g.line=33;var f=(d=c.value)!==n?d:s.value;t=t.writeEscaped(f),t.data+='"\n                        data-code="',g.line=34;var v=(d=c.code)!==n?d:s.code;t=t.writeEscaped(v),t.data+='"\n                        ',g.line=35;var m=(d=c.exclusion)!==n?d:(d=s.exclusion)!==n?d:e.resolveLooseUp(["exclusion"]);t=_.call(u,e,{params:[m],fn:a},t),t.data+="\n                    />\n                    ",g.line=37;var y=(d=c.legacy)!==n?d:(d=s.legacy)!==n?d:e.resolveLooseUp(["legacy"]);t=_.call(u,e,{params:[!y],fn:i},t),t.data+='\n                    <span class="choice_content">',g.line=38;var w=(d=c.value)!==n?d:s.value;t=t.write(w),t.data+="</span>\n                    ",g.line=39;var b=(d=c.tip)!==n?d:s.tip;t=_.call(u,e,{params:[b],fn:r},t),t.data+="\n                    ",g.line=40;var x=(d=c.img)!==n?d:s.img;return t=_.call(u,e,{params:[x],fn:o},t),t.data+="\n                </label>\n            </li>\n        ",t}function c(e,t,a){var i=e.data,r=e.affix;t.data+="\n        ",g.line=4,g.line=4;var o=(d=r.isOther)!==a?d:(d=i.isOther)!==a?d:e.resolveLooseUp(["isOther"]);return t=_.call(u,e,{params:[o],fn:n,inverse:s},t),t.data+="\n    ",t}function l(e,t,n){var a=e.data,i=e.affix;t.data+='<ul class="options_column ';var r=(d=i.className)!==n?d:(d=a.className)!==n?d:e.resolveLooseUp(["className"]);t=t.writeEscaped(r),t.data+='">\n    ',g.line=3,g.line=3;var o=(d=i.options)!==n?i.options.items:(d=a.options)!==n?d.items:e.resolveLooseUp(["options","items"]);return t=b.call(u,e,{params:[o],fn:c},t),t.data+="\n</ul>",t}var d,u=this,h=u.root,p=u.buffer,f=u.scope,m=u.runtime,g=(u.name,u.pos),y=(f.data,f.affix,h.nativeCommands),w=h.utils,b=(w.callFn,w.callCommand,y.range,y.foreach,y.forin,y.each),_=(y["with"],y["if"]),x=(y.set,y.include,y.parse,y.extend,y.block);y.macro,y["debugger"];p.data+="",g.line=1;var k;return m.extendTplName="./base",p=p.async(function(e){m.extendTplBuffer=e}),m.extendTplFn=v,p=p.writeEscaped(k),p.data+="\n",g.line=2,p=x.call(u,f,{params:["content"],fn:l},p)};return e}(),S=function(e){var t=m,n=te,a=new n(t);return e=function(){return a.render.apply(a,arguments)}}(),I=function(e){var t=g,n=te,a=new n(t);return e=function(){return a.render.apply(a,arguments)}}(),O=function(e){var t=b,n=te,a=new n(t);return e=function(){return a.render.apply(a,arguments)}}(),R=function(e){var t=_,n=te,a=new n(t);return e=function(){return a.render.apply(a,arguments)}}(),j=function(e){var t=x,n=te,a=new n(t);return e=function(){return a.render.apply(a,arguments)}}(),U=function(e){var t=k,n=te,a=new n(t);return e=function(){return a.render.apply(a,arguments)}}(),P=function(e){var t=T,n=te,a=new n(t);return e=function(){return a.render.apply(a,arguments)}}(),N=function(e){function t(e){var t={};return e?(r.map(e.split("&"),function(e){var n,e=e.split("=");try{n=decodeURIComponent(e[1]||"")}catch(a){n=null}t[e[0]]=n}),t):t}var n=ee,i=ne,r=a,c=o,l=s.t,d=q,u=i.extend({initializer:function(){if(this.index=this.get("index"),this.data=this.get("data"),this.survey=this.get("survey"),this.condition=this.get("condition"),this.container=this.get("container"),this.validationRules=this.data.validationRules||{},this.isLegacy=this.survey.legacy,this.code=this.data.code,this.canUrlPreset=this.data.canUrlPreset||!1,this.displayWithPreset=this.data.displayWithPreset||!1,this.data.index=this.index+1,this.condition&&!r.isEmptyObject(this.condition)&&(this.hasLogic=!0),this.canUrlPreset){var e=this.data.preValue||"",n=e.match(/^\$\$(\w+)/);if(n){var a=n[1],i=t(location.href.split("?")[1])[a];this.presetAnswer=i?d(i):null}else this.presetAnswer=e}return this.enabled=!this.hasLogic,this._init(),this},_init:function(){this.addTitleExtra(),this.render(),this.hasLogic&&this.toggleHide(!1),this.addListener(),this.survey.fire("refreshSeq")},addTitleExtra:function(){var e=this.data.description;e+='<span class="title_extra">',r.inArray(this.data.type,["ShortText","LongText","ImageUpload","Rank","RankMatrix"])||(e=e+"("+(this.data.validationRules.optionLimit?l("options_limit",{limit:this.data.validationRules.optionLimit}):l(this.data.type))+")"),this.data.description=e+"</span>"},render:function(){this.dom=this.getLayout(),this.tip=n(".question_tip",this.dom),this.data.tip&&r.trim(this.data.tip.length)>0&&this.tip.css("display","block"),this.seqContainer=n(".seq",this.dom),this.errorMsgWrap=n(".error_tips span",this.dom),this.container.append(this.dom),this.data.descriptionImgs&&this.data.descriptionImgs.length>0&&this.initSlide(),this.fillAnswer()},initSlide:function(){var e=this;this.slide=n(".question_gallery",this.dom),n("img",this.slide).attr("src",r.encodeImageSrc(this.data.descriptionImgs[0]),!0),this.slide.css({display:"block"}),n("img",this.slide).on("click",function(t){t.stopPropagation();var n=document.documentElement.clientHeight,a="";a=e.isLegacy?"max-height: "+n+"px; height: expression(this.height > "+n+" ? "+(n-50)+" : auto)":"max-height: "+n+"px",e.survey.showOverlay('<div class="image_preview"><img style="'+a+'" src="'+e.data.descriptionImgs[0]+'"/></div>')})},setSeq:function(e){this.seq!==e&&(this.seq=e,this.seqContainer.text(~~e))},fillAnswer:function(){},addListener:function(){},goNext:function(){if(!this.isLegacy){var e=this.dom[0].getBoundingClientRect(),t=new c(window,{scrollTop:n(window).scrollTop()+(e.top+e.height-300)},{duration:.5,easing:"easeOut",complete:function(){}});t.run()}},showError:function(e){r.each(n(".error_tips",this.dom),function(t){n("span",n(t)).text(e)})},showRequireError:function(e,t){if(this.isLegacy)r.each(n(".error_tips",this.dom),function(t){n("span",n(t)).text(e)});else{if(void 0!==t){var a=n(".required_error",this.dom).item(t+1);return void a.text(e).parent().addClass("hasError")}r.each(n(".required_error",this.dom),function(t){n(t).text(e)})}},notify:function(){this.hasLogic&&this.toggleHide(this.logic.validate())},toggleHide:function(e){e?(this.enabled=!0,this.dom.addClass("q_show").removeClass("q_hide")):(this.enabled=!1,this.dom.removeClass("q_show").addClass("q_hide")),this.survey.fire("refreshSeq")}},{ATTRS:{}});return e=u}(),Q=function(e){var t=ee,n=i,a=r,o=E;s.t;return e={httpService:{saveQuestion:function(e){o.answer(e),n.record(e.question_code,[e.sub_question_code,e.option_code,e.option_checked,e.answer_value].join("$"))}},_isStartWith:function(e,t){return 0==e.indexOf(t)},_disableInput:function(e){for(var n=e.all("input"),a=0,i=n.length;i>a;a++)n[a].checked||"text"==n[a].type||t(n[a]).attr("disabled","disabled").parent().addClass("disabled")},_enableInput:function(e){for(var n=e.all("input"),a=0,i=n.length;i>a;a++)n[a].checked||t(n[a]).removeAttr("disabled").parent().removeClass("disabled")},_findAndPop:function(e,t){for(var n=[],a=0;a<t.length;a++)for(var i=0;i<e.length;i++)if(e[i].code===t[a].answer_code){n.push(e[i]),e.splice(i,1);break}return n},_findAndPopMatrix:function(e,t){for(var n=[],a=0;a<t.length;a++)for(var i=0;i<e.length;i++)if(t[a].question_code.indexOf(e[i].code)>=0){n.push(e[i]),e.splice(i,1);break}return n},_doRandom:{group:function(e){var t,n=e.items.length-1;return e.items[n].isOther&&(t=e.items[n],e.items.splice(n,1)),e.items=a.group(e.items,"randomGroupNumber",[0]),t&&e.items.push(t),e},shuffle:function(e){var t,n=e.items.length-1;return e.items[n].isOther&&(t=e.items[n],e.items.splice(n,1)),e.items=a.shuffle(e.items),t&&e.items.push(t),e},flip:function(e){if(Math.round(Math.random()))return e;var t,n=e.items.length-1;return e.items[n].isOther&&(t=e.items[n],e.items.splice(n,1)),e.items=a.flip(e.items),t&&e.items.push(t),e},show:function(e,t){var n=e.randomShow,i=n-t.length,r=[];return t.length&&(r=this._findAndPop(e.items,t)),e.items=r.concat(a.pick(e.items,i)),e=a.shuffle(e)},showSubQ:function(e,t){var n=e.randomShow,i=[];t.length&&(i=this._findAndPopMatrix(e.items,t));var r=n-i.length;return e.items=i.concat(a.pick(e.items,r)),e=a.shuffle(e)}},_randomOptions:function(e,t){var n=e.options||{},a=n.randomType;a&&(e.options=this._doRandom[a](n,t||[]))},_randomSubQ:function(e,t){var n=e.subQuestions||{},a=n.randomType;a&&("show"==a&&(a="showSubQ"),e.subQustions=this._doRandom[a](n,t||[]))}}}(),M=function(e){var t=A,n=te,a=new n(t);return e=function(){return a.render.apply(a,arguments)}}(),D=function(e){var t=ee,n=K,a=N,i=Q,r=S,o=s.t,c=a.extend({_init:function(){this.currentCode={},c.superclass._init.call(this)},getLayout:function(){var e=this.data;return e.legacy=this.isLegacy,e.type=e.type.toLowerCase(),e.required=e.validationRules.required?"required":"",e.isShown=this.hasLogic?"q_hide":"",e.options.items.length<=5?e.className="one_column":e.options.items.length<=10?e.className="two_column":e.className="three_column",e.other_input_placeholder=o("default_placeholder"),e.img_postfix=this.isLegacy?"_400x400.jpg":"",i._randomOptions(e,this.survey.answers[this.code]),t(r(e))},containAnswer:function(e,t){for(var n=0,a=e.length;a>n;n++)if(e[n].question_code.split("-")[1]==t&&1==e[n].answer_code)return!0;return!1},getOtherAnswer:function(e,t){if(!e||!e.length)return"";for(var n=0,a=e.length;a>n;n++)if(e[n].question_code.split("-")[1]==t&&1==e[n].answer_code)return e[n].answer_value;return""},fillAnswer:function(){var e,a=this,i=(this.data.index,this.dom.all("input[type=checkbox]")),r=this.survey.answers[this.code],o="";a.otherInput=t('.other_option_input input[type="text"]',a.dom),a.otherInput.val(o),r?(e=n.map(r,function(e,t){return 1===~~e.option_checked?(e.answer_value&&e.answer_value.length>0&&(o=e.answer_value),e.option_code):void 0}),a.otherInput.val(o),n.each(i,function(n,i){var r=t(n),o=r.attr("data-code");e.indexOf(o)>-1&&(a.survey.isIE6?r[0].defaultChecked=!0:r[0].checked=!0,r.parent().addClass("checked"),a.currentCode[o]=1,"true"===r.attr("data-other")&&a.otherInput.css("display","block"))}),this.validateAnswers(),this.hasAnswer=!0):this.hasAnswer=!1},validateAnswers:function(){var e=this.dom.all("input:checked").length,t=this.validationRules.optionLimit||1/0;e>=+t?i._disableInput(this.dom):i._enableInput(this.dom)},render:function(){c.superclass.render.call(this)},addListener:function(){var e=this;return this.optionsContainer=t(".question_content",this.dom),this.dom.delegate("click",".choice_image_scale",function(n){n.stopPropagation();var a=t(n.currentTarget),i=a.next("img"),r=document.documentElement.clientHeight,o="",s="";return e.isLegacy?(s=i.attr("src").replace(/^http:/,"").replace("_400x400.jpg",""),o="max-height: "+r+"px; height: expression(this.height > "+r+" ? "+(r-50)+" : auto); width: 95%;"):(s=i.attr("src").replace(/^http:/,""),o="max-height: "+r+"px; max-width: 95%;"),e.survey.showOverlay('<div class="image_preview"><img style="'+o+'" src="'+s+'"/></div>'),!1}),this.optionsContainer.delegate("change",'input[type="checkbox"]',function(a){a.stopPropagation();var r=t(a.currentTarget),o=e.validationRules.optionLimit||1/0,s=r.attr("data-code"),c=r.attr("data-value"),l=r.attr("data-exclusion"),d=r[0].checked?1:0,u=r.parent(),h=[],p=[],f=[];d?(!e.isLegacy&&u.addClass("checked"),l?n.each(e.optionsContainer.all("input:checked"),function(n){var a=t(n),i=a.attr("data-code"),r=a.attr("data-value");i!=s&&(n.checked=!1,!e.isLegacy&&a.parent().removeClass("checked"),h.push(i),p.push(0),f.push(r),e.currentCode[i]=0)}):n.each(e.optionsContainer.all("[data-exclusion='true']"),function(n){var a=t(n),i=a.attr("data-code"),r=a.attr("data-value");i!=s&&n.checked&&(n.checked=!1,!e.isLegacy&&a.parent().removeClass("checked"),h.push(i),p.push(0),f.push(r),e.currentCode[i]=0)})):!e.isLegacy&&u.removeClass("checked");var v=e.optionsContainer.all("input:checked").length;v>=+o?i._disableInput(e.optionsContainer):i._enableInput(e.optionsContainer);var m=e.dom.one('[data-other="true"]');m&&m.parent().hasClass("checked")?e.otherInput&&(e.otherInput.show(),e.otherInput[0].focus(),c=n.trim(e.otherInput.val())):e.otherInput&&e.otherInput.hide(),h.push(s),p.push(d),e.currentCode[s]=d,e.dom.removeClass("invalid"),i.httpService.saveQuestion({question_code:e.code,option_code:h.join("|"),option_checked:p.join("|")});var g=n.map(n.keys(e.currentCode),function(t){return e.currentCode[t]?t:void 0});e.survey.logic.input(e.code,n.filter(g,function(e){return void 0!==e}))}),e.otherInput&&e.otherInput.on("blur",function(n){var a=t(n.currentTarget),r=a.attr("data-code"),o=a.val();e.dom.removeClass("invalid"),i.httpService.saveQuestion({question_code:e.code,option_code:r,option_checked:"1",answer_value:o,isOther:!0})}),!1},validate:function(){var e=this.dom.all("input:checked").length,t=this.validationRules.optionLimit||1/0,n=e>=1&&t>=e,a=this.validationRules.required?n:!0;this.dom.one('[data-other="true"]');return this.enabled?(a?this.dom.removeClass("invalid"):(1>e?this.showRequireError(o("required")):e>t&&this.showRequireError(o("options_limit",{limit:t})),this.dom.addClass("invalid")),{hash:+this.code,isValid:a}):{hash:+this.code,isValid:!0}},getValue:function(e){var t=[];return n.each(this.currentCode,function(e){t.push(e)}),this.enabled?t:void 0}},{ATTRS:{}});return e=c}(),V=function(e){var t=ee,n=K,a=N,i=Q,r=I,o=s.t,c=q,l=y,d=a.extend({getLayout:function(e,a){var a=this.data;return a.placeholder=a.placeholder&&0!=n.trim(a.placeholder).length?a.placeholder:o("default_placeholder"),a.legacy=this.legacy,a.type=a.type.toLowerCase(),a.required=a.validationRules.required?"required":"",a.isShown=this.hasLogic||this.canUrlPreset&&!this.displayWithPreset?"q_hide":"",t(r(a))},fillAnswer:function(){var e=this,t=this.dom.one("input"),a=this.survey.answers[this.code],r=this.presetAnswer,o=!1;if(this.canUrlPreset){if(r&&""!=n.trim(r))a=r,o=!0;else{if(!a)return this.hasAnswer=!1,t.placeholder(),void(!o&&this.enabled&&this.canUrlPreset&&this.dom.addClass("q_show").removeClass("q_hide"));a=a[0].answer_value||""}o&&(this.checkAnswer(a)?(this.survey.logic.input(this.code,a),i.httpService.saveQuestion({question_code:e.code,answer_value:a})):this.toggleHide(!0,!1))}else a=a?a[0].answer_value||"":"";t.val(a),!o&&this.enabled&&this.canUrlPreset&&(this.checkAnswer(a)?this.displayWithPreset||this.dom.addClass("q_show").removeClass("q_hide"):this.dom.addClass("q_show").removeClass("q_hide")),this.hasAnswer=!0,t.placeholder()},checkAnswer:function(e){return this.validationRules.required?""!=e:!0},render:function(){d.superclass.render.call(this)},addListener:function(){var e=this,a=this.dom.one("input");this.code,this.data.index;a.on("input propertychange",n.throttle(function(n){var a=t(n.currentTarget),i=a.val();e.survey.logic.input(e.code,i)},200)),a.on("blur",function(n){var a=t(n.currentTarget);e.dom.removeClass("invalid"),setTimeout(function(){var t=a.val();"true"!=a.attr("data-placeholder-enable")&&e.validate()&&(t=c(t),i.httpService.saveQuestion({question_code:e.code,answer_value:t}),e.survey.logic.input(e.code,t))},0)})},validate:function(){if(!this.enabled)return{hash:+this.code,isValid:!0};var e,t=n.trim(this.getValue()),a=this.data.verify,i=this.validationRules.required,r={result:!0},s=!1;return s=i?!!t:!0,a?(r=l.verify(t,a),e=s&&r.result):e=s,s?a&&!r.result?(this.showRequireError(r.msg),this.dom.addClass("invalid")):this.dom.removeClass("invalid"):(this.showRequireError(o("required")),this.dom.addClass("invalid")),{hash:+this.code,isValid:e}},toggleHide:function(e,t){this.canUrlPreset&&!this.displayWithPreset&&e||d.superclass.toggleHide.call(this,e)},getValue:function(){return this.enabled?[this.dom.one("input").val()]:void 0}},{ATTRS:{}});return e=d}(),z=function(e){var t=ee,n=K,a=N,i=Q,r=O,o=s.t,c=q,l=a.extend({getLayout:function(){var e=this.data;return e.placeholder=e.placeholder&&0!=n.trim(e.placeholder).length?e.placeholder:o("default_placeholder"),e.legacy=this.legacy,e.type=e.type.toLowerCase(),e.required=e.validationRules.required?"required":"",e.isShown=this.hasLogic||this.canUrlPreset&&!this.displayWithPreset?"q_hide":"",t(r(e))},fillAnswer:function(){var e=this,t=this.dom.one("textarea"),a=this.survey.answers[this.code],r=this.presetAnswer,o=!1;if(this.canUrlPreset){if(r&&""!=n.trim(r))a=r,o=!0;else{if(!a)return this.hasAnswer=!1,t.placeholder(),void(!o&&this.enabled&&this.canUrlPreset&&this.dom.addClass("q_show").removeClass("q_hide"));a=a[0].answer_value||""}o&&(this.checkAnswer(a)?(this.survey.logic.input(this.code,a),i.httpService.saveQuestion({question_code:e.code,answer_value:a})):this.toggleHide(!0,!1))}else a=a?a[0].answer_value||"":"";t.val(a),!o&&this.enabled&&this.canUrlPreset&&(this.checkAnswer(a)?this.displayWithPreset||this.dom.addClass("q_show").removeClass("q_hide"):this.dom.addClass("q_show").removeClass("q_hide")),this.hasAnswer=!0,t.placeholder()},checkAnswer:function(e){return this.validationRules.required?""!=e:!0},render:function(){l.superclass.render.call(this),t("textarea",this.dom).placeholder()},addListener:function(){var e=this,a=this.dom.one("textarea");this.code,this.data.index;a.on("input propertychange",n.throttle(function(n){var a=t(n.currentTarget),i=a.val();e.survey.logic.input(e.code,i)},200)),a.on("blur",function(n){var a=t(n.currentTarget);e.dom.removeClass("invalid"),setTimeout(function(){var t=a.val();"true"!=a.attr("data-placeholder-enable")&&e.validate()&&(t=c(t),i.httpService.saveQuestion({question_code:e.code,answer_value:t}),e.survey.logic.input(e.code,t))},0)})},validate:function(){var e=n.trim(this.getValue()),t=this.validationRules.required?""!=e:!0;return this.enabled?(t?this.dom.removeClass("invalid"):(this.showRequireError(o("required")),this.dom.addClass("invalid")),{hash:+this.code,isValid:t}):{hash:+this.code,isValid:!0}},toggleHide:function(e,t){this.canUrlPreset&&!this.displayWithPreset&&e||l.superclass.toggleHide.call(this,e)},getValue:function(){return this.enabled?[this.dom.one("textarea").val()]:void 0}},{ATTRS:{}});return e=l}(),$=function(e){var t=ee,n=K,a=N,i=Q,r=R,o=s.t,c=a.extend({_init:function(){this.currentCode={},c.superclass._init.call(this)},getLayout:function(){var e=this.data;return e.legacy=this.legacy,e.type=e.type.toLowerCase(),e.required=e.validationRules.required?"required":"",e.isShown=this.hasLogic?"q_hide":"",i._randomOptions(e,this.survey.answers[this.code]),i._randomSubQ(e,this.survey.answers[this.code]),t(r(e))},containAnswer:function(e,t,n){for(var a=0,i=e.length;i>a;a++){var r=e[a].question_code.split("-");if(r[1]==t&&e[a].answer_code==n)return!0}return!1},fillAnswer:function(){var e=this.survey.answers[this.code],a=this.data.index,i=this;e&&e.length?(n.each(e,function(e,n){var r=["#q"+a,e.sub_question_code,e.option_code].join("-"),o=t(r,i.dom);i.survey.isIE6?o[0].defaultChecked=!0:o[0].checked=!0,!i.isLegacy&&o.parent(2).addClass("checked"),i.currentCode[i.code+"-"+e.sub_question_code]=e.option_code}),this.hasAnswer=!0):this.hasAnswer=!1},addListener:function(){var e=this,a=t(".matrix_table table",this.dom),r=this.code;this.data.index;this.buildTableEvent(),a.delegate("click","td",function(a){"TD"==a.target.nodeName&&(n.each(t(a.currentTarget).siblings(),function(n){if("TD"==n.nodeName){!e.isLegacy&&t(n).removeClass("checked");var a=t(n).one("input");a[0].checked=!1}}),t(a.currentTarget).addClass("checked"),t(a.currentTarget).one("input")[0].checked=!0,t(a.currentTarget).one("input").fire("change"))}),a.delegate("change",'input[type="radio"]',function(a){a.stopPropagation();var o=t(a.currentTarget),s=o.attr("data-code"),c=(o.attr("data-value"),o.attr("data-row")),l=r+"-"+c;e.isLegacy||(n.each(t('[data-row="'+c+'"]',e.dom),function(e){t(e).parent(2).removeClass("checked")}),o.parent(2).addClass("checked")),e.dom.removeClass("invalid"),n.each(t(".fixed_column th",e.dom),function(e){t(e).removeClass("hasError"),t(".required_error",t(e)).text("")}),e.currentCode[l]=[s],i.httpService.saveQuestion({question_code:e.code,sub_question_code:c,option_code:s}),e.survey.logic.input(l,[s])})},render:function(){if(c.superclass.render.call(this),!this.isLegacy){var e=t(".fixed_column thead span",this.dom),a=t(".matrix_table thead tr span",this.dom),i="";n.each(a,function(e){var n=t(e),a=n.text();a.length>i.length&&(i=a)}),e.text(i)}},buildTableEvent:function(){var e=this,n=this.data.options.items.length,a={},i=!1;4>=n?a=1==this.survey.mode?{"font-size":"16px",padding:"16px","th-width":"220px","label-width":"100px"}:{"font-size":"16px",padding:"16px","th-width":"240px","label-width":"120px"}:7>=n?a=1==this.survey.mode?{"font-size":"14px",padding:"8px","th-width":"160px","label-width":"70px"}:{"font-size":"14px",padding:"8px","th-width":"160px","label-width":"80px"}:11>=n?a=1==this.survey.mode?{"font-size":"12px",padding:"7px","th-width":"120px","label-width":"45px"}:{"font-size":"12px",padding:"7px","th-width":"120px","label-width":"60px"}:(a={"font-size":"12px",padding:"7px","th-width":"120px","label-width":"60px"},i=!0);var r=t(".matrix",this.dom),o=t(".fixed_column",r),s=t(".matrix_table table",r);t("th span",o).css({"font-size":a["font-size"],padding:a.padding,width:a["th-width"]}),t("thead span",o).css({width:a["label-width"]}),t("tbody th span",s).css({"font-size":a["font-size"],padding:a.padding,width:a["th-width"]}),t("thead th span",s).css({"font-size":a["font-size"],padding:a.padding,width:a["label-width"]}),t("tbody td label",s).css({"font-size":a["font-size"],padding:"0 "+a.padding,width:a["label-width"]});var c=11;if(1==this.survey.mode&&n>11&&(c=9),i){var l=t("thead th",s),d=t(".table_control",this.dom),u=(l.length-1)%c==1,h=Math.ceil((l.length-1)/c),p=1;t("a",d).item(0).css("visibility","hidden"),h>1&&(!this.isLegacy&&t(".matrix_right_feather",e.dom).css("display","block"),d.css("display","block")),d.delegate("click","a",function(n){var a=t(n.currentTarget),i=a.attr("data-action"),r=0;switch(i){case"prev":if(1>=p)return;p==h&&(t("a",d).item(1).css("visibility","visible"),t(".matrix_right_feather",e.dom).css("display","block")),p--,u&&p==h-1?s.css({transform:"translate(-0px, 0)"}):(r=(p-1)*(c-1)*75,s.css({transform:"translate(-"+r+"px, 0)"})),1==p&&t("a",d).item(0).css("visibility","hidden");break;case"next":if(p>=h)return;t("a",d).item(0).css("visibility","visible"),u&&p+1==h?s.css({transform:"translate(-150px, 0)"}):(r=p*(c-1)*75,s.css({transform:"translate(-"+r+"px, 0)"})),p++,p==h&&(t(".matrix_right_feather",e.dom).css("display","none"),t("a",d).item(1).css("visibility","hidden"))}})}},validate:function(){var e=t(".matrix_table tbody",this.dom),n=e.all("tr"),a=!0;if(!this.enabled)return{hash:+this.code,isValid:!0};for(var i=0,r=n.length;r>i;i++){var s=t(n[i]),c=s.all("input:checked").length;c||this.showRequireError(o("required"),i),a=a&&c>=1}var l=this.validationRules.required?a:!0;return l?this.dom.removeClass("invalid"):this.dom.addClass("invalid"),{hash:+this.code,isValid:l}},getValue:function(e){return this.enabled?[this.currentCode[e]]:void 0}},{ATTRS:{}});return e=c}(),B=function(e){var t=ee,n=K,a=N,i=Q,r=j,o=s.t,c=a.extend({_init:function(){this.currentCode={},c.superclass._init.call(this)},getLayout:function(){var e=this.data;return e.legacy=this.legacy,e.type=e.type.toLowerCase(),e.required=e.validationRules.required?"required":"",e.isShown=this.hasLogic?"q_hide":"",i._randomOptions(e,this.survey.answers[this.code]),i._randomSubQ(e,this.survey.answers[this.code]),t(r(e))},containAnswer:function(e,t,n){for(var a=0,i=e.length;i>a;a++){var r=e[a].question_code.split("-");if(r[1]==t&&r[2]==n&&1==e[a].answer_code)return!0}return!1},fillAnswer:function(){var e=t(".matrix_table tbody",this.dom),a=(e.all("tr"),this.survey.answers[this.code]),i=this.data.index,r=this;if(a&&a.length){n.each(a,function(e,n){var a=["#q"+i,e.sub_question_code,e.option_code].join("-"),o=t(a,r.dom);1===+e.option_checked&&(r.survey.isIE6?o[0].defaultChecked=!0:o[0].checked=!0,o.parent(2).addClass("checked"),r.currentCode[e.sub_question_code+"-"+e.option_code]=1)});var o=t(".matrix_table tbody tr",this.dom);o.each(function(e){r.validateAnswers(t(e))}),this.hasAnswer=!0}else this.hasAnswer=!1},validateAnswers:function(e){var t=e.all("input:checked").length,n=this.validationRules.optionLimit||1/0;t>=+n?i._disableInput(e):i._enableInput(e)},addListener:function(){var e=this,a=t(".matrix_table table",this.dom);this.buildTableEvent(),a.delegate("click","td",function(e){if("TD"==e.target.nodeName){var n=t(e.currentTarget).one("input");n[0].checked=!n[0].checked,n.fire("change")}}),a.delegate("change",'input[type="checkbox"]',function(a){a.stopPropagation();var r=t(a.currentTarget),o=r.closest("tr"),s=e.validationRules.optionLimit||1/0,c=r.attr("data-code"),l=r.attr("data-value"),d=r.attr("data-exclusion"),u=r[0].checked?1:0,h=r.attr("data-row"),p=r.parent(2),f=[],v=[],m=[];u?(!e.isLegacy&&p.addClass("checked"),d?n.each(o.all("input:checked"),function(n){var a=t(n).attr("data-code"),i=t(n).attr("data-value");a!=c&&(n.checked=!1,!e.isLegacy&&t(n).parent(2).removeClass("checked"),f.push(a),v.push(0),m.push(i),e.currentCode[h+"-"+c]=0)}):n.each(o.all("[data-exclusion='true']"),function(n){var a=t(n).attr("data-code"),i=t(n).attr("data-value");a!=c&&n.checked&&(n.checked=!1,!e.isLegacy&&t(n).parent(2).removeClass("checked"),f.push(a),v.push(0),m.push(i),e.currentCode[h+"-"+c]=0)})):!e.isLegacy&&p.removeClass("checked");var g=o.all("input:checked").length;g>=+s?i._disableInput(o):i._enableInput(o),f.push(c),v.push(u),m.push(l),e.currentCode[h+"-"+c]=u,e.dom.removeClass("invalid"),n.each(t(".fixed_column th",e.dom),function(e){t(e).removeClass("hasError"),t(".required_error",t(e)).text("")}),i.httpService.saveQuestion({question_code:e.code,sub_question_code:h,option_code:f.join("|"),option_checked:v.join("|")});var y=n.map(n.keys(e.currentCode),function(t){var n=t.split("-"),a=n[0],i=n[1];return a==h&&e.currentCode[t]?i:void 0});e.survey.logic.input(e.code+"-"+h,n.filter(y,function(e){return void 0!=e}))})},render:function(){if(c.superclass.render.call(this),!this.isLegacy){var e=t(".fixed_column thead span",this.dom),a=t(".matrix_table thead tr span",this.dom),i="";n.each(a,function(e){var n=t(e),a=n.text();a.length>i.length&&(i=a)}),e.text(i)}},buildTableEvent:function(){var e=this,n=this.data.options.items.length,a={},i=!1;4>=n?a=1==this.survey.mode?{"font-size":"16px",padding:"16px","th-width":"220px","label-width":"100px"}:{"font-size":"16px",padding:"16px","th-width":"240px","label-width":"120px"}:7>=n?a=1==this.survey.mode?{"font-size":"14px",padding:"8px","th-width":"160px","label-width":"70px"}:{"font-size":"14px",padding:"8px","th-width":"160px","label-width":"80px"}:11>=n?a=1==this.survey.mode?{"font-size":"12px",padding:"7px","th-width":"120px","label-width":"45px"}:{"font-size":"12px",padding:"7px","th-width":"120px","label-width":"60px"}:(a={"font-size":"12px",padding:"7px","th-width":"120px","label-width":"60px"},i=!0);var r=t(".matrix",this.dom),o=t(".fixed_column",r),s=t(".matrix_table table",r);t("th span",o).css({"font-size":a["font-size"],padding:a.padding,width:a["th-width"]}),t("thead span",o).css({width:a["label-width"]}),t("tbody th span",s).css({"font-size":a["font-size"],padding:a.padding,width:a["th-width"]}),t("thead th span",s).css({"font-size":a["font-size"],padding:a.padding,width:a["label-width"]}),t("tbody td label",s).css({"font-size":a["font-size"],padding:"0 "+a.padding,width:a["label-width"]});var c=11;if(1==this.survey.mode&&n>11&&(c=9),i){var l=t("thead th",s),d=t(".table_control",this.dom),u=(l.length-1)%c==1,h=Math.ceil((l.length-1)/c),p=1;t("a",d).item(0).css("visibility","hidden"),h>1&&(!this.isLegacy&&t(".matrix_right_feather",e.dom).css("display","block"),d.css("display","block")),d.delegate("click","a",function(n){var a=t(n.currentTarget),i=a.attr("data-action"),r=0;switch(i){case"prev":if(1>=p)return;p==h&&(t("a",d).item(1).css("visibility","visible"),t(".matrix_right_feather",e.dom).css("display","block")),p--,u&&p==h-1?s.css({transform:"translate(-0px, 0)"}):(r=(p-1)*(c-1)*75,s.css({transform:"translate(-"+r+"px, 0)"})),1==p&&t("a",d).item(0).css("visibility","hidden");break;case"next":if(p>=h)return;t("a",d).item(0).css("visibility","visible"),u&&p+1==h?s.css({transform:"translate(-150px, 0)"}):(r=p*(c-1)*75,s.css({transform:"translate(-"+r+"px, 0)"})),p++,p==h&&(t(".matrix_right_feather",e.dom).css("display","none"),t("a",d).item(1).css("visibility","hidden"))}})}},validate:function(){var e=t(".matrix_table tbody",this.dom),n=e.all("tr"),a=this.validationRules.optionLimit||1/0,i=!0,r=!0,s=!0;if(!this.enabled)return{hash:+this.code,isValid:!0};for(var c=0,l=n.length;l>c;c++){var d=t(n[c]),u=d.all("input:checked").length;r=!0,s=!0,i=i&&u>=1&&a>=u,1>u&&(r=!1),u>a&&(s=!1),r||this.showRequireError(o("required"),c),s||this.showRequireError(o("options_limit",{limit:a}),c)}var h=this.validationRules.required?i:!0;return h?this.dom.removeClass("invalid"):this.dom.addClass("invalid"),{hash:+this.code,isValid:h}},getValue:function(e){var t=[];for(var n in this.currentCode)this.currentCode.hasOwnProperty(n)&&this.currentCode[n]&&i._isStartWith(n,e)&&t.push(this.currentCode[n]);return this.enabled?t:void 0}},{ATTRS:{}});return e=c}(),F=function(e){var t=ee,n=N,a=Q,i=ae,r=U,o=s.t,c=n.extend({getLayout:function(e,n){var n=this.data,a=this;return n.legacy=this.legacy,n.type=n.type.toLowerCase(),n.required=n.validationRules.required?"required":"",n.isShown=this.hasLogic?"q_hide":"",
n.btnText=o("upload_img"),n.allowExts=encodeURIComponent("jpg,png,jpeg,gif"),this.survey.answers[this.code]&&(a.value=this.survey.answers[this.code][0].answer_value,a.value&&""!=a.value&&(n.defaultValue=encodeURIComponent(i.stringify([{url:"/image/"+a.value}]||[])))),t(r(n))},addListener:function(){var e=this;window["uploader-"+e.code]={result:function(t,n){void 0!==n.key&&(e.value=n.key,a.httpService.saveQuestion({question_code:e.code,answer_value:n.key}))},remove:function(t){e.value="",a.httpService.saveQuestion({question_code:e.code,answer_value:void 0})}}},validate:function(){var e=this.validationRules.required?!!this.value:!0;return this.enabled?(e?this.dom.removeClass("invalid"):(this.showRequireError(o("required")),this.dom.addClass("invalid")),{hash:+this.code,isValid:e}):{hash:+this.code,isValid:!0}},getValue:function(){}},{ATTRS:{}});return e=c}(),H=function(e){var t=ee,n=K,a=N,i=Q,r=P,o=s.t,c={heart:["&#xe61b;","&#xe61c;"],star:["&#xe61d;","&#xe61e;"],like:["&#xe61f;","&#xe620;"]},l={1:["非常不满意","非常满意"],2:["非常不愿意","非常愿意"],3:["非常不认同","非常认同"],4:["非常不重要","非常重要"],5:["非常不符合","非常符合"]},d={1:["Very dissatisfied","Very Satisfied"],2:["Worst","Awesome"],3:["Strongly Disagreed","Strongly Agreed"],4:["Useless","Very important"],5:["",""]};window.survey_data&&"zh_CN"!==window.survey_data.locale&&(l=d);var u=a.extend({getLayout:function(e,a){var a=n.clone(this.data);return a.legacy=this.legacy,a.type=a.type.toLowerCase(),a.required=a.validationRules.required?"required":"",a.isShown=this.hasLogic||this.canUrlPreset&&!this.displayWithPreset?"q_hide":"","rank"==a.type?(a.isMatrix=!1,a.className="rank_type rank_"+a.magnitude):(a.isMatrix=!0,a.className="rank_type rank_matrix rank_matrix_"+a.magnitude),a.shape=c[a.shape],"0"==a.label?a.label=a.customLabel:a.label=l[a.label],t(r(a))},containAnswer:function(e,t){for(var n=0,a=e.length;a>n;n++){var i=e[n].sub_question_code;if(i==t)return e[n].option_code}return!1},fillAnswer:function(){var e=this.survey.answers[this.code];if(this.currentAnswer=null,"Rank"==this.data.type){var n=t(".rank_icon",this.dom);if(e){e=e&&e[0].option_code;for(var a=parseInt(e,10),i=0;a>i;i++)this.setActive(n.item(i));this.currentAnswer=e,this.hasAnswer=!0}else this.hasAnswer=!1}else{var r=t(".rank_matrix_item",this.dom),o=this;o.currentAnswer={},e&&e.length?(r.each(function(n,a){var i=t(n),r=i.attr("data-code"),s=o.containAnswer(e,r);if(s!==!1){for(var a=parseInt(s,10),c=t(".rank_icon",i),l=0;a>l;l++)o.setActive(c.item(l));o.currentAnswer[o.code+"-"+r]=s}}),this.hasAnswer=!0):this.hasAnswer=!1}},setActive:function(e){e.addClass("active")},clearActive:function(e){e.siblings().removeClass("active")},addListener:function(){var e,a,r=this,o=this.code;"Rank"==this.data.type?(e=this.dom.all(".rank_options"),a=this.dom.all(".rank_icon"),e.delegate("click",".rank_icon",function(e){var n=t(e.currentTarget),o=n.index(),s=n.attr("data-value");r.dom.removeClass("invalid"),!r.answer&&r.clearActive(n);for(var c=0;o>=c;c++)r.setActive(a.item(c));r.currentAnswer=s,setTimeout(function(){r.validate()&&i.httpService.saveQuestion({question_code:r.code,option_code:s,answer_value:s})},0)})):(e=this.dom.all(".rank_matrix_options"),e.delegate("click",".rank_icon",function(e){var a=t(e.currentTarget),s=a.index(),c=a.attr("data-value"),l=a.attr("data-row"),d=a.parent().all(".rank_icon");r.dom.removeClass("invalid"),n.each(t(".rank_matrix_description",r.dom),function(e){t(e).removeClass("hasError"),t(".required_error",t(e)).text("")}),!r.answer&&r.clearActive(a);for(var u=0;s>=u;u++)r.setActive(d.item(u));r.currentAnswer[o+"-"+l]=c,setTimeout(function(){i.httpService.saveQuestion({question_code:r.code,sub_question_code:l,option_code:c,answer_value:c})},0)}))},validate:function(){var e,n;if(!this.enabled)return{hash:+this.code,isValid:!0};if("Rank"==this.data.type)n=this.getValue(),e=this.validationRules.required?void 0!=n:!0,e||this.showRequireError(o("required"));else{for(var a=t(".rank_matrix_item",this.dom),i=!0,r=0,s=a.length;s>r;r++){var c=t(a[r]),l=this.code+"-"+c.attr("data-code");n=this.getValue(l),n||this.showRequireError(o("required"),r),i=i&&!!n}e=this.validationRules.required?i:!0}return e?this.dom.removeClass("invalid"):this.dom.addClass("invalid"),{hash:+this.code,isValid:e}},getValue:function(e){return this.enabled?"Rank"==this.data.type?this.currentAnswer:this.currentAnswer[e]:void 0}},{ATTRS:{}});return e=u}(),W=function(e){var t=ee,n=K,a=N,i=Q,r=M,o=s.t,c=a.extend({getLayout:function(){var e=this.data;return e.legacy=this.isLegacy,e.type=e.type.toLowerCase(),e.required=e.validationRules.required?"required":"",e.isShown=this.hasLogic?"q_hide":"",e.options.items.length<=5?e.className="one_column":e.options.items.length<=10?e.className="two_column":e.className="three_column",e.other_input_placeholder=o("default_placeholder"),e.img_postfix=this.isLegacy?"_400x400.jpg":"",i._randomOptions(e,this.survey.answers[this.code]),t(r(e))},fillAnswer:function(){var e=this.dom.all("input[type=radio]"),n=this.survey.answers[this.code],a=e.item(e.length-1);if("true"===a.attr("data-other")){var i=a.attr("data-code"),r=n&&n[0]&&i==n[0].option_code?n[0].answer_value:"";this.otherInput=t('.other_option_input input[type="text"]',this.dom),this.otherInput.val(r)}if(n){n=n[0];var o=t("#choice_"+n.option_code,this.dom);this.survey.isIE6?o[0].defaultChecked=!0:o[0].checked=!0,!this.isLegacy&&o.parent().addClass("checked"),this.currentCode=n.option_code,"true"===o.attr("data-other")&&this.otherInput.css("display","inline-block"),this.hasAnswer=!0}else this.hasAnswer=!1},addListener:function(){var e=this;return this.dom.delegate("click",".choice_image_scale",function(n){n.stopPropagation();var a=t(n.currentTarget),i=a.next("img"),r=document.documentElement.clientHeight,o="",s="";return e.isLegacy?(s=i.attr("src").replace(/^http:/,"").replace("_400x400.jpg",""),o="max-height: "+r+"px; height: expression(this.height > "+r+" ? "+(r-50)+" : auto); width: 95%;"):(s=i.attr("src").replace(/^http:/,""),o="max-height: "+r+"px; max-width: 95%;"),e.survey.showOverlay('<div class="image_preview"><img style="'+o+'" src="'+s+'"/></div>'),!1}),this.dom.delegate("change",'input[type="radio"]',function(a){a.stopPropagation();var r=t(a.currentTarget),o=r.attr("data-code"),s=r.attr("data-value"),c="true"===r.attr("data-other"),l=r.parent();e.isLegacy||(t("label",e.dom).removeClass("checked"),l.addClass("checked")),c?e.otherInput&&(e.otherInput.show(),e.otherInput[0].focus(),s=n.trim(e.otherInput.val())):e.otherInput&&e.otherInput.hide(),e.dom.removeClass("invalid"),e.currentCode=o,i.httpService.saveQuestion({question_code:e.code,option_code:o}),e.survey.logic.input(e.code,[e.currentCode])}),e.otherInput&&e.otherInput.on("blur",function(n){var a=t(n.currentTarget),r=a.attr("data-code"),o=a.val();e.dom.removeClass("invalid"),i.httpService.saveQuestion({question_code:e.code,option_code:r,isOther:!0,answer_value:o})}),!1},validate:function(){var e=this.dom.all("input:checked").length>=1,t=this.validationRules&&this.validationRules.required?e:!0;return this.enabled?(t?this.dom.removeClass("invalid"):(this.showRequireError(o("required")),this.dom.addClass("invalid")),{hash:+this.code,isValid:t}):{hash:+this.code,isValid:!0}},getValue:function(){return this.enabled?[this.currentCode]:void 0}},{ATTRS:{}});return e=c}(),J=function(e){var t=W,n=D,a=V,i=z,r=$,o=B,s=F,c=H;return e={SingleChoice:t,MultipleChoices:n,ShortText:a,LongText:i,SingleMatrix:r,MultipleMatrix:o,ImageUpload:s,Rank:c,RankMatrix:c}}(),G=function(e){var t=ee,n=ne,i=a,o=r,s=J,c=n.extend({initializer:function(){this.container=this.get("container"),this.data=this.get("data"),this.survey=this.get("survey"),this.current=this.get("current"),this.questions=[],this._buildBaseDom(),this._buildQuestions(),this.render()},_buildBaseDom:function(){var e=this.data,n=t('<div class="page '+this.current+'"></div>'),a=t('<div class="questions_wrap"></div>');n.attr("id","p-"+e.code),n.attr("data-idx",e.index),n.append('<div class="page_description_wrap"><div class="page_description">'+e.description+"</div></div>"),i.trim(e.description).length>0&&t(".page_description_wrap",n).css("display","block"),e.descriptionImgs&&(t(".page_description",n).append('<div class="page_description_img"><img src="'+i.encodeImageSrc(e.descriptionImgs[0])+'"/></div>'),t(".page_description_wrap",n).css("display","block")),n.append(a),this.dom=n,this.questionContainer=a},_buildQuestions:function(){var e=this,t=e.data,n=t.question_random,a=t.questions;n&&(a=o.group(a,"randomGroupNumber",[0]));var r=0;i.each(a,function(t,n){if(t.disabled)return!0;var a=new s[t.type]({index:r,data:t,condition:e.survey.conditions[t.code],container:e.questionContainer,survey:e.survey});e.questions.push(a),e.survey.questionQueue.push(a),e.survey.questionsByCode[a.code]=a,r++})},render:function(){this.container.append(this.dom)}});return e=c}(),X=function(e){function t(e){e=e||window.event,e.preventDefault&&e.preventDefault(),e.returnValue=!1}function n(e){for(var n=m.length;n--;)if(e.keyCode===m[n])return void t(e)}function i(e){t(e)}function r(){window.addEventListener&&window.addEventListener("DOMMouseScroll",i,!1),window.onmousewheel=document.onmousewheel=i,document.onkeydown=n}function c(){window.removeEventListener&&window.removeEventListener("DOMMouseScroll",i,!1),window.onmousewheel=document.onmousewheel=document.onkeydown=null}var l=ee,d=ne,u=a,h=G,p=o,f=L,v=s.t,m=[37,38,39,40],g=d.extend({initializer:function(){this.survey=this.get("survey"),this.legacy=this.get("legacy"),this.mode=this.get("mode"),this.isIE6=l("html").hasClass(".ks-ie6"),this.pages=[],this.container=l("#survey-content"),this.conditions=this.survey.question_conditions||{},this.questionQueue=[],this.questionsByCode={},this.currentQ=null;return this.logic=f,this._init(),this},_init:function(){var e=this,t=this.survey;this.getAnswer(),f.init(this.conditions,function(t){var n;u.each(t.show,function(t){n=e.questionsByCode[t],n&&!n.enabled&&n.toggleHide(!0,!0)}),u.each(t.hide,function(t){n=e.questionsByCode[t],n&&n.enabled&&n.toggleHide(!1)}),e.refreshSeq(),e.refreshPage()}),this._buildContent(t),this._initAnswer(this.answers),this._initOverlay(),this.addListener()},_initOverlay:function(){var e=this,t=document.documentElement.clientHeight;this.overlay=l('<div class="global_overlay" id="global-overlay"><div class="overlay_content_wrap"><a href="javascript:void(0);" class="iconfont close_overlay_btn">&#xe602;</a><div id="overlay-content"></div></div></div>'),this.olContentWrap=l("#overlay-content",this.overlay),this.overlay.height(t>650?t:650),l(".close_overlay_btn",this.overlay).on("click",function(t){e.hideOverlay()}),l("body").append(this.overlay)},showOverlay:function(e){if(this.legacy){var t=document.documentElement.scrollTop;this.overlay.css("top",t),r()}this.olContentWrap.append(e),this.overlay.css("display","block"),l("body").css("overflow","hidden")},hideOverlay:function(){this.legacy&&c(),this.overlay.css("display","none"),this.olContentWrap.empty(),l("body").css("overflow","auto")},_initAnswer:function(e){if(u.isEmptyObject(e))return this;var t=this,n={};u.each(e,function(e,a){var i=t.questionsByCode[a];if(i){var r,o=i.data.type;switch(o){case"singlechoice":n[a]=[e[0].option_code];break;case"multiplechoices":n[a]||(n[a]=[]),u.each(e,function(e,t){1===~~e.option_checked&&n[a].indexOf(e.option_code)<0&&n[a].push(e.option_code)});break;case"singlematrix":u.each(e,function(e,t){r=a+"-"+e.sub_question_code,n[r]=[e.option_code]});break;case"multiplematrix":u.each(e,function(e,t){r=a+"-"+e.sub_question_code,n[r]||(n[r]=[]),1===~~e.option_checked&&n[r].indexOf(e.option_code)<0&&n[r].push(e.option_code)});break;case"shorttext":case"longtext":n[a]=e[0].answer_value}}});var a={};u.each(this.questionQueue,function(e,t){a[e.code]=t+1}),this.logic.input(n,a)},_buildContent:function(e){for(var t=this,n=0,a=0,i=e.pages.length;i>a;a++){var r=e.pages[a];if(this.isEmptyPage(r.questions))n+=1;else{var o=a-n==0?"page_shown current":"";r.index=a-n,this.pages.push(new h({data:r,container:this.container,survey:t,current:o}))}}this.pageCount=this.pages.length,this.totalPage=this.pages.length,this.totalQ=this.questionQueue.length,this.currentPage=1,this.pageCount>1?this.container.append(l('<div class="button_wrap"><a href="javascript:void(0);" class="button" id="continue" data-action="next">'+v("next_page")+'</a><div class="loading" id="loading"></div><div class="msg" id="msg"></div></div>')):this.container.append(l('<div class="button_wrap"><a href="javascript:void(0);" class="button" id="continue" data-action="submit">'+v("submit")+'</a><div class="loading" id="loading"></div><div class="msg" id="msg"></div></div>')),this.refreshSeq(),this.refreshPage()},parseQ:function(e){return e.split("-")[0]},getAnswer:function(){var e=this,t=this.get("answer");e.answers={},u.each(t,function(t,n){var a=t[0];e.answers[a]||(e.answers[a]=[]),e.answers[a].push({sub_question_code:t[1],option_code:t[2],option_checked:t[3],answer_value:t[4]})})},refreshSeq:function(){var e=1;u.each(this.questionQueue,function(t,n){t.enabled&&!t.dom.hasClass("q_hide")&&t.setSeq(e++)})},refreshPage:function(){for(var e=0,t=l(".page",this.container),n=0,a=0,i=0,r=0;r<t.length;r++){var o=t[r];0!=l(o).all(".q_show").length?(this.currentPage-1>r&&l(o).addClass("page_shown"),l(o).removeClass("page_hide"),e++):(n++,this.currentPage-1>r&&a++,this.currentPage-1<r&&i++,l(o).addClass("page_hide"))}this.pageCount=e,e-(this.currentPage-a)>0?l("#continue").attr("data-action","next").text(v("next_page")):l("#continue").attr("data-action","submit").text(v("submit"))},getValue:function(e){var t=e.split("-"),n=t[0];return this.questionsByCode[n].getValue(e)},addListener:function(){var e=this;e.on("valueChanged",function(t){e.fireEvents(t)}),e.on("refreshSeq",function(t){e.refreshSeq(),e.refreshPage()})},fireEvents:function(e){var t=e.number,n=[],a=u.isNumber(t)?t:+t.split("-")[0];for(a+=1;a<=this.totalQ;a++)n.push(a);for(var i=0,r=n.length;r>i;i++){var o=n[i];this.questionQueue[o-1]&&this.questionQueue[o-1].fire("notify",e)}},isEmptyPage:function(e){if(e&&0!==e.length){for(var t=0;t<e.length;t++)if(!e[t].disabled)return!1;return!0}return!0},getTotalQ:function(e){for(var t=0,n=1;e>=n;n++){var a=l('[data-idx="'+(n-1)+'"]');u.each(a.all(".q_show"),function(e,n){var a=+l(e).one(".question").attr("data-qidx");a>t&&(t=a)})}return t},validate:function(e){var t=this.questionQueue,n=!0,e=e||this.totalQ,a=[];if(u.each(t,function(t,i){if(e>=i+1&&t.enabled){var r=t.validate();!r.isValid&&a.push(r.hash),n=n&&r.isValid}}),n)this.legacy&&(location.hash="_");else{var i=a[0];if(this.legacy)location.hash="q-"+a[0];else{var r=l("#q-"+i),o=r[0].getBoundingClientRect(),s=new p(window,{scrollTop:l(window).scrollTop()+o.top-300},{duration:1,easing:"easeOut",complete:function(){}});s.run()}}return n}},{ATTRS:{}});return e=g}(),Y=function(e){var t,n=ee,r=ie,c=a,l=i,d=X,p=E,f=o,v=u,m=C,g=s.t,y=h,w=function(){b=!0,n("#welcome-wrap").fadeOut(.3),n(".survey_head").fadeOut(.3),n("#survey-content").fadeOut(.3),n(".end_page_wrap").fadeIn(.5)},b=!1,_=n("body"),x={0:"&#xe614;",1:"&#xe615;",2:"&#xe613;",3:"&#xe62b;",5:"&#xe617;",6:"&#xe616;",7:"&#xe619",8:"&#xe621;",9:"&#xe625;",10:"&#xe626;",11:"&#xe628;",12:"&#xe627;",14:"&#xe629;",15:"&#xe62a;"},k={beginSurvey:function(){},submitSurvey:function(e,n){var a=t.after_submitting,i=t.after_submitting_type;p.submit().done(function(t,r,o){if(t.success){e();var s=location.search.replace("?",""),c={};s&&(c=v.parse(s));var l=c.redirect;if(l){var d=document.createElement("a");d.href=l;var u=d.host;if(m.isSafeDomain(u))return void(location.href=l)}if(1==i){a=a||"http://www.taobao.com";var h=0==a.indexOf("http")?a:"http://"+a;location.href=h}else w(a)}else 403==o.status&&"unlogin"==o.responseText?location.href="/login?redirect="+encodeURIComponent("/survey/"+window.survey_data.hash):403==o.status&&"surveySubmitted"==o.responseText?(n(g("submitted")),location.href="/"):n(500==o.status&&"sessionException"==o.responseText?g("login_timeout"):o.responseText)}).error(function(){n(g("server_exception"))})}},T={init:function(e){var a=this;if(t=e,t.answer=y.decode(n("#SurveyAnswer").val()),"review"===t.env){t.content.question_conditions={};for(var i=[],o=t.content.pages,s=o.splice(1),l=0;l<s.length;l++)o[0].questions=o[0].questions.concat(s[l].questions);var i=[];c.each(o[0].questions,function(e){e&&!e.disabled&&i.push(e)}),o[0].questions=i,location.pathname.indexOf("review")>-1&&_.prepend('<div class="global-tip">该页面用于发布流程审批，请勿对外投放！</div>'),_.addClass("review-mode")}else"test"===t.env&&_.prepend('<div class="global-tip">该页面用于问卷测试，请勿对外投放！</div>');if(p.init(r,{ctoken:t.ctoken,hook:t.hook,hash:t.hash,token:t.token,id:t.id,version:t.version,type:t.type,env:t.env},{test:!!t.test}),k.beginSurvey(),a.factory=new d({survey:t.content,answer:t.answer,legacy:!1,mode:t.mode}),0==t.mode){a.wrap=n("#welcome-wrap");var u=n(".survey_description");0==u.text().trim().length&&u.css("visibility","hidden"),n("#enter-button").text(g("begin"))}a.setLogo(t.mode),a.fitScreen(t.mode),a.addListener(t.mode),a.disabledPage={}},setLogo:function(e){var a=x[t.logo]||"";if(1!=e)if(0===t.logo.indexOf("http")||0===t.logo.indexOf("//")){var i='<img class="logo-custom" src="'+t.logo.replace(/^https?:/,"")+'"/>';n("#survey-logo").html(i).removeClass("iconfont")}else n("#survey-logo").html(a).addClass("logo"+t.logo);else if(0===t.logo.indexOf("http")||0===t.logo.indexOf("//")){var i='<img class="logo-custom" src="'+t.logo.replace(/^https?:/,"")+'"/>';n(".survey_logo").html(i)}else n(".survey_logo").html('<i class="iconfont">'+a+"</i>");if(0===t.logo.indexOf("http")||0===t.logo.indexOf("//")){var i='<img class="logo-custom" src="'+t.logo.replace(/^https?:/,"")+'"/>';n("#end-logo").html(i).removeClass("iconfont")}else n("#end-logo").html(a).addClass("logo"+t.logo)},calcEstimateTime:function(){for(var e=0,n=t.content.pages,a=0,i=n.length;i>a;a++)e+=n[a].questions.length;document.getElementById("estimate-time").innerHTML=Math.round(.5*e).toString()},fitScreen:function(e){var t=document.documentElement.clientWidth,a=document.documentElement.clientHeight,i=n(".end_page_wrap");0==e&&(850>t&&this.wrap.css({width:"818px"}),this.wrap.css({height:(a>650?a:650)+"px",display:"block"}),n(".welcome",this.wrap).css({height:(a>650?a-32:618)+"px"})),i.css({height:(a>650?a:650)+"px"})},findNextAvailablePage:function(){for(var e=this,t=n(".page"),a=this.factory,i=!1,r=a.currentPage+1;r<=a.totalPage;r++){if(!t.item(r-1).hasClass("page_hide")){delete e.disabledPage[t.item(r-1).attr("id").split("-")[1]],t.item(r-1).addClass("page_shown current"),a.currentPage=parseInt(t.item(r-1).attr("data-idx"),10)+1,r-c.keys(e.disabledPage).length<a.pageCount&&(i=!0);break}e.disabledPage[t.item(r-1).attr("id").split("-")[1]]=1}return i},showLoading:function(){n("#loading").css({visibility:"visible"})},hideLoading:function(){n("#loading").css({visibility:"hidden"})},addListener:function(e){var t=this,a=this.factory,i=!1;n(window).on("resize",function(){if(b){var e=n(".end_page_wrap"),t=document.documentElement.clientWidth,a=document.documentElement.clientHeight;850>t&&e.css({width:"850px"}),e.css({width:(850>t?850:t)+"px",height:(a>650?a:650)+"px"})}}),0==e&&n("#enter-button").on("click",function(e){n("#survey-content").css({display:"block"});var a=new f(window,{scrollTop:t.wrap.height()},{duration:.5,easing:"easeOut",complete:function(){n(e.currentTarget).css("display","none")}});a.run(),l.update()}),n("#continue").on("click",function(e){if(!i){var r=n(e.currentTarget),o=r.attr("data-action");switch(t.showLoading(),i=!0,o){case"next":if(!a.validate(a.getTotalQ(a.currentPage)))return t.hideLoading(),void(i=!1);var s=n(".current");a.currentPage=+s.attr("data-idx")+1,s.removeClass("current");var c=t.findNextAvailablePage();c?n(this).attr("data-action","next").text(g("next_page")):n(this).attr("data-action","submit").text(g("submit"));var l=new f(window,{scrollTop:n(".current").offset().top},{duration:.5,easing:"easeOut",complete:function(){t.hideLoading()}});l.run(),i=!1;break;case"submit":a.validate()?k.submitSurvey(function(){t.hideLoading()},function(e){i=!1,t.hideLoading(),n("#msg").text(e).css("visibility","visible")}):(t.hideLoading(),i=!1)}}})}};return e=T}(),Z=function(e){return e=Y}(),n.exports=Z});