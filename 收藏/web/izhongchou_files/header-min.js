KISSY.add("utils/home2014/tool",function(a,b,c,d,e){function f(){var b=a.one("#J_PageToken");return b?b.children("input").val():""}var g=d.all,h={_csrf_token:f(),login:function(){return b.check()?!0:(window.location.href="https://login.taobao.com/member/login.jhtml?redirectURL="+encodeURIComponent(window.location.href),!1)},isDaily:function(){var a=-1!==location.host.indexOf("daily");return a?!1:!0},focus:function(a,b){var c=this,d=g(".interest");d.on("click",function(d){if(d.preventDefault(),!c.login())return!1;var f=g(d.target),h=c.isDaily()?"//izhongchou.taobao.com/dream/ajax/focusProject.htm":"//izhongchou.daily.taobao.net/dream/ajax/focusProject.htm",i="0";f.hasClass("uninterest")&&(i="1"),a&&(i="1"),e({dataType:"jsonp",url:h,data:{type:i,id:b?b:f.attr("data-id"),_tb_token_:g("#J_TbToken").val()||""},jsonp:"callback",success:function(b){if("1"==b.status)if("1"==i){if(a)return location.reload(),!1;f.removeClass("uninterest").html("+ \u52a0\u5173\u6ce8")}else f.addClass("uninterest").html("\u5df2\u5173\u6ce8")},error:function(){alert("\u670d\u52a1\u5668\u8bf7\u6c42\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5")}})})}};return h},{requires:["tbc/mini-login/1.0.0/","cookie","node","io"]}),KISSY.Config&&KISSY.Config.packages&&KISSY.Config.packages.tbc||KISSY.config({packages:[{name:"tbc",path:-1===location.host.indexOf("daily")?"//g.alicdn.com/tbc/":"//g-assets.daily.taobao.net/tbc/",ignorePackageNameInUri:!0}]}),KISSY.add("page/header",function(a,b,c,d,e,f,g,h){function i(){var a=this;a.init()}var j=c.all,k=!0;i.prototype={init:function(){this.URL=f.isDaily()?"//izhongchou.taobao.com/dream/ajax/getCategory.htm":"//izhongchou.daily.taobao.net/dream/ajax/getCategory.htm",k&&(this.URL="//hstar-hi.alicdn.com/dream/ajax/getCategory.htm"),this.initStyle(),this.search(),this.codeEvent()},codeEvent:function(){e.delegate(document,"click",".twocode-btn",function(a){a.preventDefault(),j(".two-code").remove()})},initStyle:function(){var a=location.pathname.toLowerCase();a.indexOf("index.htm")>-1?j(".main.home").addClass("current"):a.indexOf("list.php")>-1||a.indexOf("dreamdetail")>-1?j(".main.list").addClass("current"):a.indexOf("agreement.php")>-1||a.indexOf("about.php")>-1||a.indexOf("teacher.php")>-1||a.indexOf("question.php")>-1||a.indexOf("server.php")>-1||a.indexOf("ruler.php")>-1?j(".main.help").addClass("current"):a.indexOf("add")>-1||a.indexOf("update")>-1||a.indexOf("seek")>-1||a.indexOf("choose")>-1||a.indexOf("pre_check_user.htm")>-1?j(".main.publish").addClass("current"):a.indexOf("myproject")>-1&&j(".main.myyzy").addClass("current")},initCate:function(){var a=this,b={dataType:"jsonp",url:this.URL,jsonp:"callback",success:function(b){"1"==b.status?a.renderCate(b.data):console.log("\u5206\u7c7b\u63a5\u53e3\u8fd4\u56de\u5931\u8d25")},error:function(){k?d({dataType:"jsonp",url:f.isDaily()?"//izhongchou.taobao.com/dream/ajax/getCategory.htm":"//izhongchou.daily.taobao.net/dream/ajax/getCategory.htm",jsonp:"callback",success:function(b){"1"==b.status?a.renderCate(b.data):console.log("\u5206\u7c7b\u63a5\u53e3\u8fd4\u56de\u5931\u8d25")},error:function(){console.log("\u670d\u52a1\u5668\u8bf7\u6c42\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5")}}):console.log("\u670d\u52a1\u5668\u8bf7\u6c42\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5")}};k&&(b.cache=!0,b.jsonpCallback="jsonpCate"),d(b)},renderCate:function(b){var c={121278001:"&#xe61d;",121280001:"&#xe61c;",121274002:"&#xe61f;",121284001:"&#xe61b;",121288001:"&#xe617;",121292001:"&#xe61a;",122018001:"&#xe619;",122020001:"&#xe61e;",123330001:"&#xe618;",123332001:"&#xe620;"},d="";a.each(b,function(a,b){d+=0==b?'<li class="first"><a href="//hi.taobao.com/market/hi/list.php?#type='+a.id+'" target="_blank"><b class="a-icon">'+c[a.id]+"</b>"+a.name+"</a></li>":'<li><a href="//hi.taobao.com/market/hi/list.php?#type='+a.id+'" target="_blank"><b class="a-icon">'+c[a.id]+"</b>"+a.name+"</a></li>"}),j(".J_navallType").html(d)},search:function(){var b=j("#J_search");if(b.length){var c="//hi.taobao.com/market/hi/list.php";b.on("click",function(){var b=a.trim(j("#q")[0].value);b=b.replace(/[\'\"\>\<]/g,""),location.href=""==b?c:c+"?query="+encodeURI(b)+"#sort=1"}),j(document).on("keydown",function(a){if(13==a.keyCode){var c=j("input:focus");c.hasClass("query")&&e.fire(b,"click")}});var d=["history","list"],i=f.isDaily()?"//izhongchou.taobao.com/dream/ajax/get_nlp.htm?k=1&_input_charset=utf-8":"//izhongchou.daily.taobao.net/dream/ajax/get_nlp.htm?k=1&_input_charset=utf-8",k=new g({plugins:[new h],sugConfig:{sourceUrl:i,node:"#q",focused:!1,resultFormat:""},statConfig:{tongjiKey:{logkey:"/wapsvip.20.100",chksum:"H46866755"}},mods:{sort:d}});k.on("beforeSubmit",function(){return e.fire(b,"click"),!1})}}},new i},{requires:["ua","node","io","event","utils/home2014/tool","tbc/search-suggest/1.4.14/index","tbc/search-suggest/1.4.14/plugin/history","tbc/search-suggest/1.4.14/new_suggest.css"]}),KISSY.use("page/header");