define("anim-base",["dom","util","promise"],function(e){var n,t,i,u,a=e("dom"),o=e("util"),r=e("promise");return n=function(e){function n(e,n,t){n=n||s;var u,a=i.data(e,r);return a||t||i.data(e,r,a={}),a&&(u=a[n],u||t||(u=a[n]=[])),u}var t,i=a,u=o,r=u.guid("ks-queue-"+u.now()+"-"),s=u.guid("ks-queue-"+u.now()+"-");return t={queueCollectionKey:r,queue:function(e,t,i){var u=n(e,t);return u.push(i),u},remove:function(e,i,a){var o,r=n(e,i,1);return r&&(o=u.indexOf(a,r),o>-1&&r.splice(o,1)),r&&!r.length&&t.clearQueue(e,i),r},clearQueues:function(e){i.removeData(e,r)},clearQueue:function(e,n){n=n||s;var t=i.data(e,r);t&&delete t[n],u.isEmptyObject(t)&&i.removeData(e,r)},dequeue:function(e,i){var u=n(e,i,1);return u&&(u.shift(),u.length||t.clearQueue(e,i)),u}},e=t}(),t=function(e){function t(e){var n=e.node,t=l.data(n,v);t||l.data(n,v,t={}),t[f.stamp(e)]=e}function i(e){var n=e.node,t=l.data(n,v);t&&(delete t[f.stamp(e)],f.isEmptyObject(t)&&l.removeData(n,v))}function u(e){var n=e.node,t=l.data(n,v);return t?!!t[f.stamp(e)]:0}function r(e){var n=e.node,t=l.data(n,p);t||l.data(n,p,t={}),t[f.stamp(e)]=e}function s(e){var n=e.node,t=l.data(n,p);t&&(delete t[f.stamp(e)],f.isEmptyObject(t)&&l.removeData(n,p))}function d(e){var n=e.node,t=l.data(n,p);return t?!!t[f.stamp(e)]:0}function c(e,n,t){var i=l.data(e,"resume"===t?p:v),u=f.merge(i);f.each(u,function(e){(void 0===n||e.config.queue===n)&&e[t]()})}var m=n,f=o,l=a,v=f.guid("ks-anim-unqueued-"+f.now()+"-"),p=f.guid("ks-anim-paused-"+f.now()+"-");return e={saveRunningAnim:t,removeRunningAnim:i,isAnimPaused:d,removePausedAnim:s,savePausedAnim:r,isAnimRunning:u,isElPaused:function(e){var n=l.data(e,p);return n&&!f.isEmptyObject(n)},isElRunning:function(e){var n=l.data(e,v);return n&&!f.isEmptyObject(n)},pauseOrResumeQueue:c,stopEl:function(e,n,t,i){t&&(void 0===i?m.clearQueues(e):i!==!1&&m.clearQueue(e,i));var u=l.data(e,v),a=f.merge(u);f.each(a,function(e){(void 0===i||e.config.queue===i)&&e.stop(n)})}}}(),i=function(e){function i(e){var n,t=e.config.complete;l.isEmptyObject(n=e._backupProps)||d.css(e.node,n),t&&t.call(e)}function u(e,n,t,i,a){var o,r=this;e.node?o=e:(l.isPlainObject(t)?o=l.clone(t):(o={complete:a},t&&(o.duration=t),i&&(o.easing=i)),o.node=e,o.to=n),o=l.merge(h,o),u.superclass.constructor.call(r),f.Defer(r),r.config=o,e=o.node,l.isPlainObject(e)||(e=d.get(o.node)),r.node=r.el=e,r._backupProps={},r._propsData={};var s={};n=o.to;for(var c in n)s[p(c)]=n[c];o.to=s}var s,d=a,c=t,m=n,f=r,l=o,v=d.NodeType,p=l.camelCase,g=l.noop,_={toggle:1,hide:1,show:1},h={duration:1,easing:"linear"};l.extend(u,f,{prepareFx:g,runInternal:function(){var e,n=this,t=n.config,i=n.node,u=n._backupProps,a=n._propsData,o=t.to,r=t.delay||0,m=t.duration;if(c.saveRunningAnim(n),l.each(o,function(e,n){l.isPlainObject(e)||(e={value:e}),a[n]=l.mix({delay:r,easing:t.easing,frame:t.frame,duration:m},e)}),i.nodeType===v.ELEMENT_NODE){if(o.width||o.height){var f=i.style;l.mix(u,{overflow:f.overflow,"overflow-x":f.overflowX,"overflow-y":f.overflowY}),f.overflow="hidden"}var p,g;if(l.each(a,function(t,a){if(e=t.value,_[e]){if(g===s&&(g="none"===d.css(i,"display")),"hide"===e&&g||"show"===e&&!g)return n.stop(!0),p=!1;u[a]=d._style(i,a),"toggle"===e&&(e=g?"show":"hide"),"hide"===e?(t.value=0,u.display="none"):(t.value=d.css(i,a),d.css(i,a,0),d.show(i))}return void 0}),p===!1)return}n.startTime=l.now(),l.isEmptyObject(a)?(n.__totalTime=1e3*m,n.__waitTimeout=setTimeout(function(){n.stop(!0)},n.__totalTime)):(n.prepareFx(),n.doStart())},isRunning:function(){return c.isAnimRunning(this)},isPaused:function(){return c.isAnimPaused(this)},pause:function(){var e=this;return e.isRunning()&&(e._runTime=l.now()-e.startTime,e.__totalTime-=e._runTime,c.removeRunningAnim(e),c.savePausedAnim(e),e.__waitTimeout?clearTimeout(e.__waitTimeout):e.doStop()),e},doStop:g,doStart:g,resume:function(){var e=this;return e.isPaused()&&(e.startTime=l.now()-e._runTime,c.removePausedAnim(e),c.saveRunningAnim(e),e.__waitTimeout?e.__waitTimeout=setTimeout(function(){e.stop(!0)},e.__totalTime):(e.beforeResume(),e.doStart())),e},beforeResume:g,run:function(){var e,n=this,t=n.config.queue;return t===!1?n.runInternal():(e=m.queue(n.node,t,n),1===e.length&&n.runInternal()),n},stop:function(e){var n,t=this,u=t.node,a=t.config.queue;if(t.isResolved()||t.isRejected())return t;if(t.__waitTimeout&&(clearTimeout(t.__waitTimeout),t.__waitTimeout=0),!t.isRunning()&&!t.isPaused())return a!==!1&&m.remove(u,a,t),t;t.doStop(e),c.removeRunningAnim(t),c.removePausedAnim(t);var o=t.defer;return e?(i(t),o.resolve([t])):o.reject([t]),a!==!1&&(n=m.dequeue(u,a),n&&n[0]&&n[0].runInternal()),t}});var w=u.Statics={isRunning:c.isElRunning,isPaused:c.isElPaused,stop:c.stopEl,Q:m};return l.each(["pause","resume"],function(e){w[e]=function(n,t){return null===t||"string"==typeof t||t===!1?c.pauseOrResumeQueue(n,t,e):c.pauseOrResumeQueue(n,void 0,e)}}),e=u}(),u=function(e){var n=i;return e=n}()});