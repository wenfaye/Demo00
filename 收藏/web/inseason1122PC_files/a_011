KISSY.add("moqie/pages/juitem/index",function(t){function a(t,a){var e="",i=a.remind.soldCount,n=a.remind.remindNum,o=a.baseinfo.itemStatus;return"blank"==o?e=n>0?"<b>"+n+"</b> \u4eba\u60f3\u4e70":"\u5373\u5c06\u5f00\u56e2":"avil"==o?e=i>0?"<b>"+i+"</b> \u4ef6\u5df2\u552e":"\u8d76\u5feb\u4e0b\u5355":("timeout"==o||"soldout"==o)&&(e=i>0?"<b>"+i+"</b> \u4ef6\u5df2\u552e":"\u62a2\u5149\u5566"),t.css({fontSize:t.attr("data-size")||14,textAlign:"left",width:"200",color:t.attr("data-color")||"#FA2960"}),t.html(e),!1}function e(t,a){var e=a.baseinfo.itemStatus;return("timeout"==e||"soldout"==e)&&t.css({background:"url(//gtms01.alicdn.com/tps/i1/TB19yiFGFXXXXatXFXXR8rl3FXX-192-192.png_100x100.jpg) no-repeat 0 0",width:100,height:100}),!1}function i(t,a){var e=n(t,a);e.css({width:120,height:40,lineHeight:"40px",fontSize:20,textAlign:"center",textDecoration:"none",borderRadius:"3",color:"#FFF"});var i=a.baseinfo.itemStatus;return"timeout"==i||"soldout"==i?e.css({background:"#BBB"}).html("\u62a2\u5149\u5566"):"blank"==i?e.css({background:"#26A96D"}).html("\u53bb\u770b\u770b"):e.css({background:"#F61D4B"}).html("\u9a6c\u4e0a\u62a2"),!1}function n(t,a,e){var i=a.baseinfo.itemUrl;"2"==e&&(i="https://detail.tmall.com/item.htm?id="+a.baseinfo.itemId+"&umpChannel=qianggou&u_channel=qianggou");var n=u("<a>").css({width:t.width(),height:t.height(),display:"block",background:"url(//g.alicdn.com/s.gif)"}).attr({href:i,target:"_blank"}).appendTo(t);return t.css({"z-index":3}),n}function o(o,r){t.each(o.itemList,function(t){var o=u('[data-itemid="'+t.baseinfo.itemId+'"]');o.each(function(o){if(1!=o.attr("data-init")){o.attr("data-init",1);var s=o.attr("data-type");"0"==s?a(o,t):"1"==s?e(o,t):"2"==s?n(o,t,r):"3"==s&&i(o,t)}})})}function r(a,e){var i;return a.length<e?i=[a]:(i=new Array(Math.ceil(a.length/e)),t.each(a,function(t,a){var n=Math.floor(a/e);i[n]?i[n].push(t):i[n]=[]})),i}function s(a,e){var i=r(a,70),n={stype:"ids",salesSite:e};t.each(i,function(a){n.itemIds=a.join(","),t.IO({url:c,dataType:"jsonp",data:n,scriptCharset:"utf-8",success:function(t){o(t,e)}})})}var c="//ju.taobao.com/json/tg/ajaxGetItemsV2.json?includeForecast=true",u=t.all;return function(a){var e={};u(".juitem",a).each(function(a){var i=t.JSON.parse(a.attr("data-json")),n=i.salesSite||"1";e[n]?e[n].push(i.itemId):e[n]=[i.itemId],a.attr("data-itemid",i.itemId),a.attr("data-type",i.type),a.attr("data-color",i.textColor),a.attr("data-size",i.fontSize)}),t.each(e,function(t,a){s(t,a)})}},{requires:["core"]});