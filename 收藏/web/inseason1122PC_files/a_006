KISSY.add("normal/3.0/index",function(o,t,n,a,e,r,i,d,l,s){var c=o.all,m=(c(window),{modsMap:{"mtp-moqie":"modMoqie","mtp-item":"modItem","mtp-juspitem":"modJuspItem","mtp-juspbrand":"modJuspBrand","mtp-pckuaitem":"modPCKuaItem","mtp-pckuabrand":"modPCKuaBrand"},init:function(){var o=this;o.floorsData=o.dataFilter(JUSPDATA.floors),o.layout(),o.initNav(),o.initHashChange()},initHashChange:function(){c(window).on("hashchange",function(){var t=location.hash;if(t){var n=o.one(o.one(t)?t:"[data-id="+t.slice(1)+"]");n&&c(window).scrollTop(n.offset().top)}}).fire("hashchange")},dataFilter:function(o){{var t=o,n=location.hash;n.slice(6).split("?")[0]}return t},layout:function(){if(this.floorsData.length){var o=a({floors:this.floorsData});c("#main").html(o),this.initFloorsHolder(),this.lazyFloor()}else c("#main").html('<div class="no-data"><s class="icon"></s><div class="text">暂时没有团购商品哦</div></div>')},initNav:function(){var t=o.one("#J_FixedNav");if(!(!t||t.all("li").length<2||c(window).width()<=1024)){var n=500;try{n=o.all(t.one(".anchor").attr("href")).offset().top}catch(a){}new s({node:t.show(),navSelector:".anchor",diffTop:0,startTop:n})}},lazyFloor:function(){var o=this;c(".J_Mod").each(function(n){var a=c(n),e=new t({autoDestory:!1,diff:{top:-5,bottom:300}});e.addCallback(a,function(){e.destroy(),o.renderFloor(a.all(".mod-content"),o.getFloorData(a.attr("id")))})})},getFloorData:function(t){var n,a=this.floorsData;return o.each(a,function(a){return a.id==t?(n=a,!1):a.subFloors&&(o.each(a.subFloors,function(o){return o.id==t?(n=o,!1):void 0}),n)?!1:void 0}),n.dataOrigin=n.dataOrigin||{},n||{}},initFloorsHolder:function(){var o=this;c(".J_Mod").each(function(t){var n=c(t);o.renderFloor(n.all(".mod-content"),o.getFloorData(n.attr("id")),!0)})},renderFloor:function(o,t,n){var a=this,e=a[a.modsMap[t.type]];e&&e(o,t,n)},modMoqie:function(o,a,e){var r={};try{r=JSON.parse(a.data.moqie_data).data}catch(i){}return r.content?void(e?o.css({height:r.content.imgHeight}):(n.init(o,r),new t({container:o}))):void o.hide()},modJuspItem:function(o,t,n){n?e.renderHolder(o,t):e.render(o,t)},modJuspBrand:function(o,t,n){n?r.renderHolder(o,t):r.render(o,t)},modPCKuaItem:function(o,t,n){n?i.renderHolder(o,t):i.render(o,t)},modPCKuaBrand:function(o,t,n){n?d.renderHolder(o,t):d.render(o,t)},modItem:function(o,t,n){n?l.renderHolder(o,t):l.render(o,t)}});return m},{requires:["jbc/lazyload","moqie/pages/moqie","./layout.tpl","./mods/mod-juspItem","./mods/mod-juspBrand","./mods/mod-pcKuaItem","./mods/mod-pcKuaBrand","./mods/mod-item","jbc/ju-elevator","core"]});